
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{DosDetection}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{i523 Big Data Analytics
Project}\label{i523-big-data-analytics-project}

\subsubsection{HID224 - Neha Rawat}\label{hid224---neha-rawat}

\subsection{ * Big Data Analytics in Detection of DDoS (Distributed
Denial-of-Service) attacks * With the increase in internet traffic,
threats on the network have also increased. Denial-of-service attacks
are cyber attacks wherein a perpetrator, due to any kind of malicious
intent, tries to make a resource on the network unavailable to its
intended users and carries it out by swamping the system or resource
with excess requests in order to overload it and prevent users from
accessing it. A much more dangerous variety of such an attack is if it
is distributed i.e. coming from various sources. Big Data analytics,
however, can be used to detect such attacks by having the ability to
store the voluminous logs of such attacks and using the data and machine
learning techniques to design an anomaly detection system (using a
classification model) to detect and prevent these attacks. This project
will aim to explore such classification models, design and train the
most optimum model and display its effects using a DDoS logs
dataset.}\label{big-data-analytics-in-detection-of-ddos-distributed-denial-of-service-attacks-with-the-increase-in-internet-traffic-threats-on-the-network-have-also-increased.-denial-of-service-attacks-are-cyber-attacks-wherein-a-perpetrator-due-to-any-kind-of-malicious-intent-tries-to-make-a-resource-on-the-network-unavailable-to-its-intended-users-and-carries-it-out-by-swamping-the-system-or-resource-with-excess-requests-in-order-to-overload-it-and-prevent-users-from-accessing-it.-a-much-more-dangerous-variety-of-such-an-attack-is-if-it-is-distributed-i.e.-coming-from-various-sources.-big-data-analytics-however-can-be-used-to-detect-such-attacks-by-having-the-ability-to-store-the-voluminous-logs-of-such-attacks-and-using-the-data-and-machine-learning-techniques-to-design-an-anomaly-detection-system-using-a-classification-model-to-detect-and-prevent-these-attacks.-this-project-will-aim-to-explore-such-classification-models-design-and-train-the-most-optimum-model-and-display-its-effects-using-a-ddos-logs-dataset.}

    \subsubsection{Data Description}\label{data-description}

\begin{itemize}
\tightlist
\item
  We will be using the dataset used for the KDD Cup of 1999, which has
  been derived from the 1998 DARPA Intrusion Detection Evaluation
  Program dataset. This was prepared and managed by MIT Lincoln Labs.
  The objective was to survey and evaluate research in intrusion
  detection. The data includes a wide variety of intrusions simulated in
  a military network environment. 
\item
  Lincoln Labs set up an environment to acquire nine weeks of raw TCP
  dump data for a local-area network (LAN) simulating a typical U.S. Air
  Force LAN. They operated the LAN as if it were a true Air Force
  environment, but peppered it with multiple attacks. The raw training
  data was about four gigabytes of compressed binary TCP dump data from
  seven weeks of network traffic. This was processed into about five
  million connection records. 
\item
  KDD Cup 1999 data link:
  \href{http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html}{link\_here}
\item
  Original DARPA datasets link:
  \href{https://www.ll.mit.edu/ideval/data/1998data.html}{link\_here} 
\item
  For the data analysis and demonstration of our model, we will use 10
  percent of the KDD Cup'99 training dataset (\textasciitilde{}500k
  rows) and test it on 10 percent of the test dataset
  (\textasciitilde{}300k rows). 
\item
  The data consists of five types of network traffic logs: normal
  traffic, DOS/DDoS - Denial of Service traffic, R2L- unauthorized
  access from a remote machine, U2R- unauthorized access to local
  superuser (root) privileges and probing- surveillance and other
  probing. This makes the task of analysis and prediction much more
  realistic, as we attempt to classify the "bad traffic" from the
  "normal traffic". Another important point to note is that the datasets
  contain a total of 24 training attack types (subsets of the above
  four), with an additional 14 types in the test data only. The purpose
  behind adding the 14 extra types in the test dataset was to prove that
  most new attacks are just variants of pre-existing attack types and
  hence can be sufficiently detected using data from the latter.
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} Reading dataset using Pandas}
        \PY{c+c1}{\PYZsh{}Datasets being used for the analysis are the 10 percent datasets placed on Google Drive under \PYZdq{}HID224\PYZdq{}}
        \PY{c+c1}{\PYZsh{}Place the code and datasets in your default directory for Jupyter Notebook}
        
        \PY{c+c1}{\PYZsh{}Loading the 10 percent training dataset}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{n}{labels\PYZus{}data} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{protocol\PYZus{}type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{service}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flag}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{src\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{land}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wrong\PYZus{}fragment}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{urgent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}failed\PYZus{}logins}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logged\PYZus{}in}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}compromised}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{root\PYZus{}shell}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{su\PYZus{}attempted}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}root}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}file\PYZus{}creations}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}shells}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}access\PYZus{}files}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}outbound\PYZus{}cmds}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}host\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}guest\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}src\PYZus{}port\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{attack\PYZus{}type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
        \PY{n}{kdd\PYZus{}train\PYZus{}10percent} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{kddcup\PYZus{}data\PYZus{}10\PYZus{}percent.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{names} \PY{o}{=} \PY{n}{labels\PYZus{}data}\PY{p}{)}
        \PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}1}]:}    duration protocol\_type service flag  src\_bytes  dst\_bytes  land  \textbackslash{}
        0         0           tcp    http   SF        181       5450     0   
        1         0           tcp    http   SF        239        486     0   
        2         0           tcp    http   SF        235       1337     0   
        3         0           tcp    http   SF        219       1337     0   
        4         0           tcp    http   SF        217       2032     0   
        5         0           tcp    http   SF        217       2032     0   
        6         0           tcp    http   SF        212       1940     0   
        7         0           tcp    http   SF        159       4087     0   
        8         0           tcp    http   SF        210        151     0   
        9         0           tcp    http   SF        212        786     0   
        
           wrong\_fragment  urgent  hot     {\ldots}       dst\_host\_srv\_count  \textbackslash{}
        0               0       0    0     {\ldots}                        9   
        1               0       0    0     {\ldots}                       19   
        2               0       0    0     {\ldots}                       29   
        3               0       0    0     {\ldots}                       39   
        4               0       0    0     {\ldots}                       49   
        5               0       0    0     {\ldots}                       59   
        6               0       0    0     {\ldots}                       69   
        7               0       0    0     {\ldots}                       79   
        8               0       0    0     {\ldots}                       89   
        9               0       0    1     {\ldots}                       99   
        
           dst\_host\_same\_srv\_rate  dst\_host\_diff\_srv\_rate  \textbackslash{}
        0                     1.0                     0.0   
        1                     1.0                     0.0   
        2                     1.0                     0.0   
        3                     1.0                     0.0   
        4                     1.0                     0.0   
        5                     1.0                     0.0   
        6                     1.0                     0.0   
        7                     1.0                     0.0   
        8                     1.0                     0.0   
        9                     1.0                     0.0   
        
           dst\_host\_same\_src\_port\_rate  dst\_host\_srv\_diff\_host\_rate  \textbackslash{}
        0                         0.11                         0.00   
        1                         0.05                         0.00   
        2                         0.03                         0.00   
        3                         0.03                         0.00   
        4                         0.02                         0.00   
        5                         0.02                         0.00   
        6                         1.00                         0.04   
        7                         0.09                         0.04   
        8                         0.12                         0.04   
        9                         0.12                         0.05   
        
           dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
        0                   0.0                       0.0                   0.0   
        1                   0.0                       0.0                   0.0   
        2                   0.0                       0.0                   0.0   
        3                   0.0                       0.0                   0.0   
        4                   0.0                       0.0                   0.0   
        5                   0.0                       0.0                   0.0   
        6                   0.0                       0.0                   0.0   
        7                   0.0                       0.0                   0.0   
        8                   0.0                       0.0                   0.0   
        9                   0.0                       0.0                   0.0   
        
           dst\_host\_srv\_rerror\_rate  attack\_type  
        0                       0.0      normal.  
        1                       0.0      normal.  
        2                       0.0      normal.  
        3                       0.0      normal.  
        4                       0.0      normal.  
        5                       0.0      normal.  
        6                       0.0      normal.  
        7                       0.0      normal.  
        8                       0.0      normal.  
        9                       0.0      normal.  
        
        [10 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}2}]:}             duration     src\_bytes     dst\_bytes           land  \textbackslash{}
        count  494021.000000  4.940210e+05  4.940210e+05  494021.000000   
        mean       47.979302  3.025610e+03  8.685324e+02       0.000045   
        std       707.746472  9.882181e+05  3.304000e+04       0.006673   
        min         0.000000  0.000000e+00  0.000000e+00       0.000000   
        25\%         0.000000  4.500000e+01  0.000000e+00       0.000000   
        50\%         0.000000  5.200000e+02  0.000000e+00       0.000000   
        75\%         0.000000  1.032000e+03  0.000000e+00       0.000000   
        max     58329.000000  6.933756e+08  5.155468e+06       1.000000   
        
               wrong\_fragment         urgent            hot  num\_failed\_logins  \textbackslash{}
        count   494021.000000  494021.000000  494021.000000      494021.000000   
        mean         0.006433       0.000014       0.034519           0.000152   
        std          0.134805       0.005510       0.782103           0.015520   
        min          0.000000       0.000000       0.000000           0.000000   
        25\%          0.000000       0.000000       0.000000           0.000000   
        50\%          0.000000       0.000000       0.000000           0.000000   
        75\%          0.000000       0.000000       0.000000           0.000000   
        max          3.000000       3.000000      30.000000           5.000000   
        
                   logged\_in  num\_compromised            {\ldots}             \textbackslash{}
        count  494021.000000    494021.000000            {\ldots}              
        mean        0.148247         0.010212            {\ldots}              
        std         0.355345         1.798326            {\ldots}              
        min         0.000000         0.000000            {\ldots}              
        25\%         0.000000         0.000000            {\ldots}              
        50\%         0.000000         0.000000            {\ldots}              
        75\%         0.000000         0.000000            {\ldots}              
        max         1.000000       884.000000            {\ldots}              
        
               dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
        count   494021.000000       494021.000000           494021.000000   
        mean       232.470778          188.665670                0.753780   
        std         64.745380          106.040437                0.410781   
        min          0.000000            0.000000                0.000000   
        25\%        255.000000           46.000000                0.410000   
        50\%        255.000000          255.000000                1.000000   
        75\%        255.000000          255.000000                1.000000   
        max        255.000000          255.000000                1.000000   
        
               dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
        count           494021.000000                494021.000000   
        mean                 0.030906                     0.601935   
        std                  0.109259                     0.481309   
        min                  0.000000                     0.000000   
        25\%                  0.000000                     0.000000   
        50\%                  0.000000                     1.000000   
        75\%                  0.040000                     1.000000   
        max                  1.000000                     1.000000   
        
               dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
        count                494021.000000         494021.000000   
        mean                      0.006684              0.176754   
        std                       0.042133              0.380593   
        min                       0.000000              0.000000   
        25\%                       0.000000              0.000000   
        50\%                       0.000000              0.000000   
        75\%                       0.000000              0.000000   
        max                       1.000000              1.000000   
        
               dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
        count             494021.000000         494021.000000   
        mean                   0.176443              0.058118   
        std                    0.380919              0.230590   
        min                    0.000000              0.000000   
        25\%                    0.000000              0.000000   
        50\%                    0.000000              0.000000   
        75\%                    0.000000              0.000000   
        max                    1.000000              1.000000   
        
               dst\_host\_srv\_rerror\_rate  
        count             494021.000000  
        mean                   0.057412  
        std                    0.230140  
        min                    0.000000  
        25\%                    0.000000  
        50\%                    0.000000  
        75\%                    0.000000  
        max                    1.000000  
        
        [8 rows x 38 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{}Loading the 10 percent testing dataset}
        \PY{n}{kdd\PYZus{}test\PYZus{}10percent} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{corrected.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{names} \PY{o}{=} \PY{n}{labels\PYZus{}data}\PY{p}{)}
        \PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:}    duration protocol\_type   service flag  src\_bytes  dst\_bytes  land  \textbackslash{}
        0         0           udp   private   SF        105        146     0   
        1         0           udp   private   SF        105        146     0   
        2         0           udp   private   SF        105        146     0   
        3         0           udp   private   SF        105        146     0   
        4         0           udp   private   SF        105        146     0   
        5         0           udp   private   SF        105        146     0   
        6         0           udp  domain\_u   SF         29          0     0   
        7         0           udp   private   SF        105        146     0   
        8         0           udp   private   SF        105        146     0   
        9         0           tcp      http   SF        223        185     0   
        
           wrong\_fragment  urgent  hot       {\ldots}        dst\_host\_srv\_count  \textbackslash{}
        0               0       0    0       {\ldots}                       254   
        1               0       0    0       {\ldots}                       254   
        2               0       0    0       {\ldots}                       254   
        3               0       0    0       {\ldots}                       254   
        4               0       0    0       {\ldots}                       254   
        5               0       0    0       {\ldots}                       255   
        6               0       0    0       {\ldots}                         3   
        7               0       0    0       {\ldots}                       253   
        8               0       0    0       {\ldots}                       254   
        9               0       0    0       {\ldots}                       255   
        
           dst\_host\_same\_srv\_rate  dst\_host\_diff\_srv\_rate  \textbackslash{}
        0                    1.00                    0.01   
        1                    1.00                    0.01   
        2                    1.00                    0.01   
        3                    1.00                    0.01   
        4                    1.00                    0.01   
        5                    1.00                    0.00   
        6                    0.30                    0.30   
        7                    0.99                    0.01   
        8                    1.00                    0.01   
        9                    1.00                    0.00   
        
           dst\_host\_same\_src\_port\_rate  dst\_host\_srv\_diff\_host\_rate  \textbackslash{}
        0                         0.00                         0.00   
        1                         0.00                         0.00   
        2                         0.00                         0.00   
        3                         0.00                         0.00   
        4                         0.01                         0.00   
        5                         0.01                         0.00   
        6                         0.30                         0.00   
        7                         0.00                         0.00   
        8                         0.00                         0.00   
        9                         0.01                         0.01   
        
           dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
        0                   0.0                       0.0                   0.0   
        1                   0.0                       0.0                   0.0   
        2                   0.0                       0.0                   0.0   
        3                   0.0                       0.0                   0.0   
        4                   0.0                       0.0                   0.0   
        5                   0.0                       0.0                   0.0   
        6                   0.0                       0.0                   0.0   
        7                   0.0                       0.0                   0.0   
        8                   0.0                       0.0                   0.0   
        9                   0.0                       0.0                   0.0   
        
           dst\_host\_srv\_rerror\_rate     attack\_type  
        0                       0.0         normal.  
        1                       0.0         normal.  
        2                       0.0         normal.  
        3                       0.0  snmpgetattack.  
        4                       0.0  snmpgetattack.  
        5                       0.0  snmpgetattack.  
        6                       0.0         normal.  
        7                       0.0         normal.  
        8                       0.0  snmpgetattack.  
        9                       0.0         normal.  
        
        [10 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:}             duration     src\_bytes     dst\_bytes           land  \textbackslash{}
        count  311029.000000  3.110290e+05  3.110290e+05  311029.000000   
        mean       17.902736  1.731702e+03  7.479937e+02       0.000029   
        std       407.644400  1.276567e+05  1.612018e+04       0.005379   
        min         0.000000  0.000000e+00  0.000000e+00       0.000000   
        25\%         0.000000  1.050000e+02  0.000000e+00       0.000000   
        50\%         0.000000  5.200000e+02  0.000000e+00       0.000000   
        75\%         0.000000  1.032000e+03  0.000000e+00       0.000000   
        max     57715.000000  6.282565e+07  5.203179e+06       1.000000   
        
               wrong\_fragment         urgent            hot  num\_failed\_logins  \textbackslash{}
        count   311029.000000  311029.000000  311029.000000      311029.000000   
        mean         0.000762       0.000051       0.014677           0.002363   
        std          0.040367       0.009821       0.312068           0.049990   
        min          0.000000       0.000000       0.000000           0.000000   
        25\%          0.000000       0.000000       0.000000           0.000000   
        50\%          0.000000       0.000000       0.000000           0.000000   
        75\%          0.000000       0.000000       0.000000           0.000000   
        max          3.000000       3.000000     101.000000           4.000000   
        
                   logged\_in  num\_compromised            {\ldots}             \textbackslash{}
        count  311029.000000    311029.000000            {\ldots}              
        mean        0.172476         0.011243            {\ldots}              
        std         0.377794         1.958325            {\ldots}              
        min         0.000000         0.000000            {\ldots}              
        25\%         0.000000         0.000000            {\ldots}              
        50\%         0.000000         0.000000            {\ldots}              
        75\%         0.000000         0.000000            {\ldots}              
        max         1.000000       796.000000            {\ldots}              
        
               dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
        count   311029.000000       311029.000000           311029.000000   
        mean       235.282681          199.193914                0.793494   
        std         60.913298          100.306470                0.387090   
        min          0.000000            0.000000                0.000000   
        25\%        255.000000          244.000000                0.970000   
        50\%        255.000000          255.000000                1.000000   
        75\%        255.000000          255.000000                1.000000   
        max        255.000000          255.000000                1.000000   
        
               dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
        count           311029.000000                311029.000000   
        mean                 0.024953                     0.547919   
        std                  0.096003                     0.491963   
        min                  0.000000                     0.000000   
        25\%                  0.000000                     0.000000   
        50\%                  0.000000                     1.000000   
        75\%                  0.010000                     1.000000   
        max                  1.000000                     1.000000   
        
               dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
        count                311029.000000         311029.000000   
        mean                      0.004566              0.058764   
        std                       0.035773              0.231296   
        min                       0.000000              0.000000   
        25\%                       0.000000              0.000000   
        50\%                       0.000000              0.000000   
        75\%                       0.000000              0.000000   
        max                       1.000000              1.000000   
        
               dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
        count             311029.000000         311029.000000   
        mean                   0.058791              0.142659   
        std                    0.232997              0.344380   
        min                    0.000000              0.000000   
        25\%                    0.000000              0.000000   
        50\%                    0.000000              0.000000   
        75\%                    0.000000              0.000000   
        max                    1.000000              1.000000   
        
               dst\_host\_srv\_rerror\_rate  
        count             311029.000000  
        mean                   0.141693  
        std                    0.346573  
        min                    0.000000  
        25\%                    0.000000  
        50\%                    0.000000  
        75\%                    0.000000  
        max                    1.000000  
        
        [8 rows x 38 columns]
\end{Verbatim}
            
    \subsubsection{Data Exploration}\label{data-exploration}

We now proceed with some basic data exploration on the training dataset.
All modifications made on the training dataset (feauture engineering)
will be replicated on the test dataset (to ensure apples-to-apples
comparison).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{math}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{core}\PY{n+nn}{.}\PY{n+nn}{interactiveshell} \PY{k}{import} \PY{n}{InteractiveShell}
        \PY{n}{InteractiveShell}\PY{o}{.}\PY{n}{ast\PYZus{}node\PYZus{}interactivity} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{all}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{}Checking for null values in train and test datasets}
        
        \PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}
        \PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}No nulls found}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} False
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} False
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{}Comparing categorical variables across train and test datasets}
        
        \PY{n+nb}{len}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{protocol\PYZus{}type}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{protocol\PYZus{}type}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} 3
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} ['icmp', 'tcp', 'udp']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{protocol\PYZus{}type}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{protocol\PYZus{}type}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} 3
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} ['icmp', 'tcp', 'udp']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{service}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{service}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} 66
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} ['IRC',
          'X11',
          'Z39\_50',
          'auth',
          'bgp',
          'courier',
          'csnet\_ns',
          'ctf',
          'daytime',
          'discard',
          'domain',
          'domain\_u',
          'echo',
          'eco\_i',
          'ecr\_i',
          'efs',
          'exec',
          'finger',
          'ftp',
          'ftp\_data',
          'gopher',
          'hostnames',
          'http',
          'http\_443',
          'imap4',
          'iso\_tsap',
          'klogin',
          'kshell',
          'ldap',
          'link',
          'login',
          'mtp',
          'name',
          'netbios\_dgm',
          'netbios\_ns',
          'netbios\_ssn',
          'netstat',
          'nnsp',
          'nntp',
          'ntp\_u',
          'other',
          'pm\_dump',
          'pop\_2',
          'pop\_3',
          'printer',
          'private',
          'red\_i',
          'remote\_job',
          'rje',
          'shell',
          'smtp',
          'sql\_net',
          'ssh',
          'sunrpc',
          'supdup',
          'systat',
          'telnet',
          'tftp\_u',
          'tim\_i',
          'time',
          'urh\_i',
          'urp\_i',
          'uucp',
          'uucp\_path',
          'vmnet',
          'whois']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{service}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{service}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} 65
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} ['IRC',
          'X11',
          'Z39\_50',
          'auth',
          'bgp',
          'courier',
          'csnet\_ns',
          'ctf',
          'daytime',
          'discard',
          'domain',
          'domain\_u',
          'echo',
          'eco\_i',
          'ecr\_i',
          'efs',
          'exec',
          'finger',
          'ftp',
          'ftp\_data',
          'gopher',
          'hostnames',
          'http',
          'http\_443',
          'icmp',
          'imap4',
          'iso\_tsap',
          'klogin',
          'kshell',
          'ldap',
          'link',
          'login',
          'mtp',
          'name',
          'netbios\_dgm',
          'netbios\_ns',
          'netbios\_ssn',
          'netstat',
          'nnsp',
          'nntp',
          'ntp\_u',
          'other',
          'pm\_dump',
          'pop\_2',
          'pop\_3',
          'printer',
          'private',
          'remote\_job',
          'rje',
          'shell',
          'smtp',
          'sql\_net',
          'ssh',
          'sunrpc',
          'supdup',
          'systat',
          'telnet',
          'tftp\_u',
          'tim\_i',
          'time',
          'urp\_i',
          'uucp',
          'uucp\_path',
          'vmnet',
          'whois']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{flag}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{o}{.}\PY{n}{flag}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} 11
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} ['OTH', 'REJ', 'RSTO', 'RSTOS0', 'RSTR', 'S0', 'S1', 'S2', 'S3', 'SF', 'SH']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{flag}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{o}{.}\PY{n}{flag}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} 11
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} ['OTH', 'REJ', 'RSTO', 'RSTOS0', 'RSTR', 'S0', 'S1', 'S2', 'S3', 'SF', 'SH']
\end{Verbatim}
            
    We see that the "service" column has one less type in the test dataset
than in the train dataset. We would not have been aware of this if we
had not checked the test dataset. For simplicity, we remove the
categorical variable columns for our analysis.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}Removing the categorical variable columns}
         \PY{n}{new\PYZus{}labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{src\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{land}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wrong\PYZus{}fragment}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{urgent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}failed\PYZus{}logins}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logged\PYZus{}in}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}compromised}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{root\PYZus{}shell}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{su\PYZus{}attempted}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}root}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}file\PYZus{}creations}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}shells}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}access\PYZus{}files}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}outbound\PYZus{}cmds}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}host\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}guest\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}src\PYZus{}port\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{attack\PYZus{}type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod} \PY{o}{=} \PY{n}{kdd\PYZus{}train\PYZus{}10percent}\PY{p}{[}\PY{n}{new\PYZus{}labels}\PY{p}{]}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:} (494021, 39)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:}             duration     src\_bytes     dst\_bytes           land  \textbackslash{}
         count  494021.000000  4.940210e+05  4.940210e+05  494021.000000   
         mean       47.979302  3.025610e+03  8.685324e+02       0.000045   
         std       707.746472  9.882181e+05  3.304000e+04       0.006673   
         min         0.000000  0.000000e+00  0.000000e+00       0.000000   
         25\%         0.000000  4.500000e+01  0.000000e+00       0.000000   
         50\%         0.000000  5.200000e+02  0.000000e+00       0.000000   
         75\%         0.000000  1.032000e+03  0.000000e+00       0.000000   
         max     58329.000000  6.933756e+08  5.155468e+06       1.000000   
         
                wrong\_fragment         urgent            hot  num\_failed\_logins  \textbackslash{}
         count   494021.000000  494021.000000  494021.000000      494021.000000   
         mean         0.006433       0.000014       0.034519           0.000152   
         std          0.134805       0.005510       0.782103           0.015520   
         min          0.000000       0.000000       0.000000           0.000000   
         25\%          0.000000       0.000000       0.000000           0.000000   
         50\%          0.000000       0.000000       0.000000           0.000000   
         75\%          0.000000       0.000000       0.000000           0.000000   
         max          3.000000       3.000000      30.000000           5.000000   
         
                    logged\_in  num\_compromised            {\ldots}             \textbackslash{}
         count  494021.000000    494021.000000            {\ldots}              
         mean        0.148247         0.010212            {\ldots}              
         std         0.355345         1.798326            {\ldots}              
         min         0.000000         0.000000            {\ldots}              
         25\%         0.000000         0.000000            {\ldots}              
         50\%         0.000000         0.000000            {\ldots}              
         75\%         0.000000         0.000000            {\ldots}              
         max         1.000000       884.000000            {\ldots}              
         
                dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         count   494021.000000       494021.000000           494021.000000   
         mean       232.470778          188.665670                0.753780   
         std         64.745380          106.040437                0.410781   
         min          0.000000            0.000000                0.000000   
         25\%        255.000000           46.000000                0.410000   
         50\%        255.000000          255.000000                1.000000   
         75\%        255.000000          255.000000                1.000000   
         max        255.000000          255.000000                1.000000   
         
                dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         count           494021.000000                494021.000000   
         mean                 0.030906                     0.601935   
         std                  0.109259                     0.481309   
         min                  0.000000                     0.000000   
         25\%                  0.000000                     0.000000   
         50\%                  0.000000                     1.000000   
         75\%                  0.040000                     1.000000   
         max                  1.000000                     1.000000   
         
                dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         count                494021.000000         494021.000000   
         mean                      0.006684              0.176754   
         std                       0.042133              0.380593   
         min                       0.000000              0.000000   
         25\%                       0.000000              0.000000   
         50\%                       0.000000              0.000000   
         75\%                       0.000000              0.000000   
         max                       1.000000              1.000000   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count             494021.000000         494021.000000   
         mean                   0.176443              0.058118   
         std                    0.380919              0.230590   
         min                    0.000000              0.000000   
         25\%                    0.000000              0.000000   
         50\%                    0.000000              0.000000   
         75\%                    0.000000              0.000000   
         max                    1.000000              1.000000   
         
                dst\_host\_srv\_rerror\_rate  
         count             494021.000000  
         mean                   0.057412  
         std                    0.230140  
         min                    0.000000  
         25\%                    0.000000  
         50\%                    0.000000  
         75\%                    0.000000  
         max                    1.000000  
         
         [8 rows x 38 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{}Do the same for test data to keep the columns consistent}
         
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod} \PY{o}{=} \PY{n}{kdd\PYZus{}test\PYZus{}10percent}\PY{p}{[}\PY{n}{new\PYZus{}labels}\PY{p}{]}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} (311029, 39)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:}             duration     src\_bytes     dst\_bytes           land  \textbackslash{}
         count  311029.000000  3.110290e+05  3.110290e+05  311029.000000   
         mean       17.902736  1.731702e+03  7.479937e+02       0.000029   
         std       407.644400  1.276567e+05  1.612018e+04       0.005379   
         min         0.000000  0.000000e+00  0.000000e+00       0.000000   
         25\%         0.000000  1.050000e+02  0.000000e+00       0.000000   
         50\%         0.000000  5.200000e+02  0.000000e+00       0.000000   
         75\%         0.000000  1.032000e+03  0.000000e+00       0.000000   
         max     57715.000000  6.282565e+07  5.203179e+06       1.000000   
         
                wrong\_fragment         urgent            hot  num\_failed\_logins  \textbackslash{}
         count   311029.000000  311029.000000  311029.000000      311029.000000   
         mean         0.000762       0.000051       0.014677           0.002363   
         std          0.040367       0.009821       0.312068           0.049990   
         min          0.000000       0.000000       0.000000           0.000000   
         25\%          0.000000       0.000000       0.000000           0.000000   
         50\%          0.000000       0.000000       0.000000           0.000000   
         75\%          0.000000       0.000000       0.000000           0.000000   
         max          3.000000       3.000000     101.000000           4.000000   
         
                    logged\_in  num\_compromised            {\ldots}             \textbackslash{}
         count  311029.000000    311029.000000            {\ldots}              
         mean        0.172476         0.011243            {\ldots}              
         std         0.377794         1.958325            {\ldots}              
         min         0.000000         0.000000            {\ldots}              
         25\%         0.000000         0.000000            {\ldots}              
         50\%         0.000000         0.000000            {\ldots}              
         75\%         0.000000         0.000000            {\ldots}              
         max         1.000000       796.000000            {\ldots}              
         
                dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         count   311029.000000       311029.000000           311029.000000   
         mean       235.282681          199.193914                0.793494   
         std         60.913298          100.306470                0.387090   
         min          0.000000            0.000000                0.000000   
         25\%        255.000000          244.000000                0.970000   
         50\%        255.000000          255.000000                1.000000   
         75\%        255.000000          255.000000                1.000000   
         max        255.000000          255.000000                1.000000   
         
                dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         count           311029.000000                311029.000000   
         mean                 0.024953                     0.547919   
         std                  0.096003                     0.491963   
         min                  0.000000                     0.000000   
         25\%                  0.000000                     0.000000   
         50\%                  0.000000                     1.000000   
         75\%                  0.010000                     1.000000   
         max                  1.000000                     1.000000   
         
                dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         count                311029.000000         311029.000000   
         mean                      0.004566              0.058764   
         std                       0.035773              0.231296   
         min                       0.000000              0.000000   
         25\%                       0.000000              0.000000   
         50\%                       0.000000              0.000000   
         75\%                       0.000000              0.000000   
         max                       1.000000              1.000000   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count             311029.000000         311029.000000   
         mean                   0.058791              0.142659   
         std                    0.232997              0.344380   
         min                    0.000000              0.000000   
         25\%                    0.000000              0.000000   
         50\%                    0.000000              0.000000   
         75\%                    0.000000              0.000000   
         max                    1.000000              1.000000   
         
                dst\_host\_srv\_rerror\_rate  
         count             311029.000000  
         mean                   0.141693  
         std                    0.346573  
         min                    0.000000  
         25\%                    0.000000  
         50\%                    0.000000  
         75\%                    0.000000  
         max                    1.000000  
         
         [8 rows x 38 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{c+c1}{\PYZsh{}Exploring the target variable}
         \PY{c+c1}{\PYZsh{}According to the data documentation the attack types can be divided into \PYZdq{}normal\PYZdq{} and 4 different attack types (in the train and test data)}
         
         \PY{n}{attack\PYZus{}labs\PYZus{}all} \PY{o}{=} \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{len}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{dos\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{back.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{land.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{neptune.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pod.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{smurf.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{teardrop.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{utr\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{buffer\PYZus{}overflow.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{loadmodule.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{perl.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rootkit.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{rtl\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ftp\PYZus{}write.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{guess\PYZus{}passwd.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{imap.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{multihop.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phf.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{spy.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{warezclient.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{warezmaster.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{probe\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ipsweep.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{nmap.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{portsweep.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{satan.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
         \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{dos\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DOS.}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{utr\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{U2R}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{rtl\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R2L.}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{probe\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{probe.}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{df} \PY{o}{=} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Attack Types in Training Data}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Value Counts}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}We see that majority of the attacks are DOS attacks (98.67 percent)}
         \PY{c+c1}{\PYZsh{}So for simplicity we will just classify the labels as \PYZdq{}normal.\PYZdq{} and \PYZdq{}bad.\PYZdq{} attacks}
         
         \PY{c+c1}{\PYZsh{}Checking in the test dataset as well (has extra attack types too)}
         \PY{n}{attack\PYZus{}labs\PYZus{}tall} \PY{o}{=} \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{len}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{dos\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{back.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{land.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{neptune.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pod.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{smurf.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{teardrop.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{apache2.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mailbomb.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{processtable.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{udpstorm.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{utr\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{buffer\PYZus{}overflow.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{loadmodule.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{perl.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rootkit.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ps.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sqlattack.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{xterm.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{httptunnel.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{rtl\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ftp\PYZus{}write.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{guess\PYZus{}passwd.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{imap.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{multihop.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phf.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{spy.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{warezclient.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{warezmaster.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{named.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sendmail.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{snmpgetattack.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{snmpguess.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{worm.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{xlock.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{xsnoop.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{probe\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ipsweep.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{nmap.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{portsweep.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{satan.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mscan.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{saint.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
         \PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{dos\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DOS.}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{utr\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{U2R}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{rtl\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R2L.}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{probe\PYZus{}list}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{probe.}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{df} \PY{o}{=} \PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Attack Types in Test Data}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Value Counts}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Here too we see extra attack types but maximum of the labels (out of all attack types) consist of DOS (91.78 percent) }
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} 23
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
DOS.       391458
normal.     97278
probe.       4107
R2L.         1126
U2R            52
Name: attack\_type, dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} <matplotlib.figure.Figure at 0x266b0dc90f0>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x266add949e8>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} Text(0.5,0,'Attack Types in Training Data')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} Text(0,0.5,'Value Counts')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} 38
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
DOS.       229853
normal.     60593
R2L.        16189
probe.       4166
U2R           228
Name: attack\_type, dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} <matplotlib.figure.Figure at 0x266b0dc9c88>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x266a86baf28>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} Text(0.5,0,'Attack Types in Test Data')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} Text(0,0.5,'Value Counts')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_19_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_19_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}Creating pairplots for some continuous variables (first 15) in the training dataset}
         \PY{c+c1}{\PYZsh{}change the labels to only show \PYZsq{}normal\PYZsq{} and \PYZsq{}bad\PYZsq{} as the attack types}
         \PY{n}{attack\PYZus{}labs} \PY{o}{=} \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{attack\PYZus{}labs}\PY{p}{[}\PY{n}{attack\PYZus{}labs}\PY{o}{!=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{normal.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bad.}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{attack\PYZus{}labs}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{train\PYZus{}data\PYZus{}for\PYZus{}pairplot} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{15}\PY{p}{]}\PY{p}{,}\PY{n}{attack\PYZus{}labs}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Pairplot}
         \PY{n}{var\PYZus{}plot} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{data} \PY{o}{=} \PY{n}{train\PYZus{}data\PYZus{}for\PYZus{}pairplot}\PY{p}{,} \PY{n}{hue} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{attack\PYZus{}type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scatter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}var\PYZus{}plot.savefig(\PYZdq{}pairplot.png\PYZdq{}) }
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} bad.       396743
         normal.     97278
         Name: attack\_type, dtype: int64
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_20_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Even though we have plotted the distributions and correlations for the
first few variables, we can make two important observations: the data
seems skewed and there do not seem to be a lot of strong linear
correlations visible between these variables. Since we will be using
machine learning techniques like K-Nearest Neighbors (involving distance
metrics) along with other algorithms and will also be verifying results
using clustering (unsupervised check), we should scale the continuous
variables.

    \subsubsection{Data Preprocessing :
Scaling}\label{data-preprocessing-scaling}

In this step, we scale the continuous variables in our training dataset
as part of the data pre-processing. We will later use the same
transformation for the test data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{}Creating train dataset without the target column for scaling}
         
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}var} \PY{o}{=} \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}var}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}var}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}var}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n+nb}{type}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}var}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Scaling only for continuous variables \PYZhy{}\PYZhy{} so we remove the discrete variables}
         \PY{c+c1}{\PYZsh{}Creating a list of the discrete valued columns (mentioned in the documentation for the dataset) and removing them from the scaling dataset}
         \PY{n}{cont\PYZus{}labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{src\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wrong\PYZus{}fragment}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{urgent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}failed\PYZus{}logins}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}compromised}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}root}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}file\PYZus{}creations}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}shells}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}access\PYZus{}files}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}outbound\PYZus{}cmds}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}src\PYZus{}port\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{other\PYZus{}labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{land}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logged\PYZus{}in}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{root\PYZus{}shell}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{su\PYZus{}attempted}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}host\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}guest\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}forscale} \PY{o}{=} \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{n}{cont\PYZus{}labels}\PY{p}{]}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}forscale}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}forscale}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}others} \PY{o}{=} \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{n}{other\PYZus{}labels}\PY{p}{]}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}others}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}others}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} (494021, 38)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}             duration     src\_bytes     dst\_bytes           land  \textbackslash{}
         count  494021.000000  4.940210e+05  4.940210e+05  494021.000000   
         mean       47.979302  3.025610e+03  8.685324e+02       0.000045   
         std       707.746472  9.882181e+05  3.304000e+04       0.006673   
         min         0.000000  0.000000e+00  0.000000e+00       0.000000   
         25\%         0.000000  4.500000e+01  0.000000e+00       0.000000   
         50\%         0.000000  5.200000e+02  0.000000e+00       0.000000   
         75\%         0.000000  1.032000e+03  0.000000e+00       0.000000   
         max     58329.000000  6.933756e+08  5.155468e+06       1.000000   
         
                wrong\_fragment         urgent            hot  num\_failed\_logins  \textbackslash{}
         count   494021.000000  494021.000000  494021.000000      494021.000000   
         mean         0.006433       0.000014       0.034519           0.000152   
         std          0.134805       0.005510       0.782103           0.015520   
         min          0.000000       0.000000       0.000000           0.000000   
         25\%          0.000000       0.000000       0.000000           0.000000   
         50\%          0.000000       0.000000       0.000000           0.000000   
         75\%          0.000000       0.000000       0.000000           0.000000   
         max          3.000000       3.000000      30.000000           5.000000   
         
                    logged\_in  num\_compromised            {\ldots}             \textbackslash{}
         count  494021.000000    494021.000000            {\ldots}              
         mean        0.148247         0.010212            {\ldots}              
         std         0.355345         1.798326            {\ldots}              
         min         0.000000         0.000000            {\ldots}              
         25\%         0.000000         0.000000            {\ldots}              
         50\%         0.000000         0.000000            {\ldots}              
         75\%         0.000000         0.000000            {\ldots}              
         max         1.000000       884.000000            {\ldots}              
         
                dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         count   494021.000000       494021.000000           494021.000000   
         mean       232.470778          188.665670                0.753780   
         std         64.745380          106.040437                0.410781   
         min          0.000000            0.000000                0.000000   
         25\%        255.000000           46.000000                0.410000   
         50\%        255.000000          255.000000                1.000000   
         75\%        255.000000          255.000000                1.000000   
         max        255.000000          255.000000                1.000000   
         
                dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         count           494021.000000                494021.000000   
         mean                 0.030906                     0.601935   
         std                  0.109259                     0.481309   
         min                  0.000000                     0.000000   
         25\%                  0.000000                     0.000000   
         50\%                  0.000000                     1.000000   
         75\%                  0.040000                     1.000000   
         max                  1.000000                     1.000000   
         
                dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         count                494021.000000         494021.000000   
         mean                      0.006684              0.176754   
         std                       0.042133              0.380593   
         min                       0.000000              0.000000   
         25\%                       0.000000              0.000000   
         50\%                       0.000000              0.000000   
         75\%                       0.000000              0.000000   
         max                       1.000000              1.000000   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count             494021.000000         494021.000000   
         mean                   0.176443              0.058118   
         std                    0.380919              0.230590   
         min                    0.000000              0.000000   
         25\%                    0.000000              0.000000   
         50\%                    0.000000              0.000000   
         75\%                    0.000000              0.000000   
         max                    1.000000              1.000000   
         
                dst\_host\_srv\_rerror\_rate  
         count             494021.000000  
         mean                   0.057412  
         std                    0.230140  
         min                    0.000000  
         25\%                    0.000000  
         50\%                    0.000000  
         75\%                    0.000000  
         max                    1.000000  
         
         [8 rows x 38 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}    duration  src\_bytes  dst\_bytes  land  wrong\_fragment  urgent  hot  \textbackslash{}
         0         0        181       5450     0               0       0    0   
         1         0        239        486     0               0       0    0   
         2         0        235       1337     0               0       0    0   
         3         0        219       1337     0               0       0    0   
         4         0        217       2032     0               0       0    0   
         5         0        217       2032     0               0       0    0   
         6         0        212       1940     0               0       0    0   
         7         0        159       4087     0               0       0    0   
         8         0        210        151     0               0       0    0   
         9         0        212        786     0               0       0    1   
         
            num\_failed\_logins  logged\_in  num\_compromised            {\ldots}             \textbackslash{}
         0                  0          1                0            {\ldots}              
         1                  0          1                0            {\ldots}              
         2                  0          1                0            {\ldots}              
         3                  0          1                0            {\ldots}              
         4                  0          1                0            {\ldots}              
         5                  0          1                0            {\ldots}              
         6                  0          1                0            {\ldots}              
         7                  0          1                0            {\ldots}              
         8                  0          1                0            {\ldots}              
         9                  0          1                0            {\ldots}              
         
            dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         0               9                   9                     1.0   
         1              19                  19                     1.0   
         2              29                  29                     1.0   
         3              39                  39                     1.0   
         4              49                  49                     1.0   
         5              59                  59                     1.0   
         6               1                  69                     1.0   
         7              11                  79                     1.0   
         8               8                  89                     1.0   
         9               8                  99                     1.0   
         
            dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         0                     0.0                         0.11   
         1                     0.0                         0.05   
         2                     0.0                         0.03   
         3                     0.0                         0.03   
         4                     0.0                         0.02   
         5                     0.0                         0.02   
         6                     0.0                         1.00   
         7                     0.0                         0.09   
         8                     0.0                         0.12   
         9                     0.0                         0.12   
         
            dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         0                         0.00                   0.0   
         1                         0.00                   0.0   
         2                         0.00                   0.0   
         3                         0.00                   0.0   
         4                         0.00                   0.0   
         5                         0.00                   0.0   
         6                         0.04                   0.0   
         7                         0.04                   0.0   
         8                         0.04                   0.0   
         9                         0.05                   0.0   
         
            dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  dst\_host\_srv\_rerror\_rate  
         0                       0.0                   0.0                       0.0  
         1                       0.0                   0.0                       0.0  
         2                       0.0                   0.0                       0.0  
         3                       0.0                   0.0                       0.0  
         4                       0.0                   0.0                       0.0  
         5                       0.0                   0.0                       0.0  
         6                       0.0                   0.0                       0.0  
         7                       0.0                   0.0                       0.0  
         8                       0.0                   0.0                       0.0  
         9                       0.0                   0.0                       0.0  
         
         [10 rows x 38 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} (494021, 32)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}             duration     src\_bytes     dst\_bytes  wrong\_fragment  \textbackslash{}
         count  494021.000000  4.940210e+05  4.940210e+05   494021.000000   
         mean       47.979302  3.025610e+03  8.685324e+02        0.006433   
         std       707.746472  9.882181e+05  3.304000e+04        0.134805   
         min         0.000000  0.000000e+00  0.000000e+00        0.000000   
         25\%         0.000000  4.500000e+01  0.000000e+00        0.000000   
         50\%         0.000000  5.200000e+02  0.000000e+00        0.000000   
         75\%         0.000000  1.032000e+03  0.000000e+00        0.000000   
         max     58329.000000  6.933756e+08  5.155468e+06        3.000000   
         
                       urgent            hot  num\_failed\_logins  num\_compromised  \textbackslash{}
         count  494021.000000  494021.000000      494021.000000    494021.000000   
         mean        0.000014       0.034519           0.000152         0.010212   
         std         0.005510       0.782103           0.015520         1.798326   
         min         0.000000       0.000000           0.000000         0.000000   
         25\%         0.000000       0.000000           0.000000         0.000000   
         50\%         0.000000       0.000000           0.000000         0.000000   
         75\%         0.000000       0.000000           0.000000         0.000000   
         max         3.000000      30.000000           5.000000       884.000000   
         
                     num\_root  num\_file\_creations            {\ldots}             \textbackslash{}
         count  494021.000000       494021.000000            {\ldots}              
         mean        0.011352            0.001083            {\ldots}              
         std         2.012718            0.096416            {\ldots}              
         min         0.000000            0.000000            {\ldots}              
         25\%         0.000000            0.000000            {\ldots}              
         50\%         0.000000            0.000000            {\ldots}              
         75\%         0.000000            0.000000            {\ldots}              
         max       993.000000           28.000000            {\ldots}              
         
                dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         count   494021.000000       494021.000000           494021.000000   
         mean       232.470778          188.665670                0.753780   
         std         64.745380          106.040437                0.410781   
         min          0.000000            0.000000                0.000000   
         25\%        255.000000           46.000000                0.410000   
         50\%        255.000000          255.000000                1.000000   
         75\%        255.000000          255.000000                1.000000   
         max        255.000000          255.000000                1.000000   
         
                dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         count           494021.000000                494021.000000   
         mean                 0.030906                     0.601935   
         std                  0.109259                     0.481309   
         min                  0.000000                     0.000000   
         25\%                  0.000000                     0.000000   
         50\%                  0.000000                     1.000000   
         75\%                  0.040000                     1.000000   
         max                  1.000000                     1.000000   
         
                dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         count                494021.000000         494021.000000   
         mean                      0.006684              0.176754   
         std                       0.042133              0.380593   
         min                       0.000000              0.000000   
         25\%                       0.000000              0.000000   
         50\%                       0.000000              0.000000   
         75\%                       0.000000              0.000000   
         max                       1.000000              1.000000   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count             494021.000000         494021.000000   
         mean                   0.176443              0.058118   
         std                    0.380919              0.230590   
         min                    0.000000              0.000000   
         25\%                    0.000000              0.000000   
         50\%                    0.000000              0.000000   
         75\%                    0.000000              0.000000   
         max                    1.000000              1.000000   
         
                dst\_host\_srv\_rerror\_rate  
         count             494021.000000  
         mean                   0.057412  
         std                    0.230140  
         min                    0.000000  
         25\%                    0.000000  
         50\%                    0.000000  
         75\%                    0.000000  
         max                    1.000000  
         
         [8 rows x 32 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} (494021, 6)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}                 land      logged\_in     root\_shell   su\_attempted  \textbackslash{}
         count  494021.000000  494021.000000  494021.000000  494021.000000   
         mean        0.000045       0.148247       0.000111       0.000036   
         std         0.006673       0.355345       0.010551       0.007793   
         min         0.000000       0.000000       0.000000       0.000000   
         25\%         0.000000       0.000000       0.000000       0.000000   
         50\%         0.000000       0.000000       0.000000       0.000000   
         75\%         0.000000       0.000000       0.000000       0.000000   
         max         1.000000       1.000000       1.000000       2.000000   
         
                is\_host\_login  is\_guest\_login  
         count       494021.0   494021.000000  
         mean             0.0        0.001387  
         std              0.0        0.037211  
         min              0.0        0.000000  
         25\%              0.0        0.000000  
         50\%              0.0        0.000000  
         75\%              0.0        0.000000  
         max              0.0        1.000000  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{}Now we scale the training dataset }
         
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{preprocessing}
         
         \PY{c+c1}{\PYZsh{}Keeping the scaling parameters from the training dataset to be later applied to the test dataset}
         \PY{n}{train\PYZus{}scaler} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}forscale}\PY{p}{)}
         \PY{n}{train\PYZus{}scaler}
         
         \PY{n}{train\PYZus{}scaler}\PY{o}{.}\PY{n}{mean\PYZus{}} 
         \PY{n}{train\PYZus{}scaler}\PY{o}{.}\PY{n}{scale\PYZus{}}
         
         \PY{c+c1}{\PYZsh{}scaling the train dataset}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data} \PY{o}{=} \PY{n}{train\PYZus{}scaler}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}forscale}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{cont\PYZus{}labels}\PY{p}{)}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled1}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled1}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}adding the binary valued variable columns}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled1}\PY{p}{,}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}others}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         \PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} StandardScaler(copy=True, with\_mean=True, with\_std=True)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} array([  4.79793025e+01,   3.02561030e+03,   8.68532425e+02,
                  6.43292492e-03,   1.41694381e-05,   3.45187755e-02,
                  1.51815409e-04,   1.02121165e-02,   1.13517442e-02,
                  1.08294992e-03,   1.09307094e-04,   1.00805431e-03,
                  0.00000000e+00,   3.32285690e+02,   2.92906557e+02,
                  1.76686659e-01,   1.76608808e-01,   5.74334087e-02,
                  5.77189431e-02,   7.91547343e-01,   2.09823874e-02,
                  2.89968038e-02,   2.32470778e+02,   1.88665670e+02,
                  7.53779698e-01,   3.09057307e-02,   6.01934756e-01,
                  6.68350131e-03,   1.76753964e-01,   1.76442621e-01,
                  5.81176104e-02,   5.74116687e-02])
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} array([  7.07745756e+02,   9.88217101e+05,   3.30399678e+04,
                  1.34805112e-01,   5.51025235e-03,   7.82101790e-01,
                  1.55195812e-02,   1.79832444e+00,   2.01271629e+00,
                  9.64157811e-02,   1.10199990e-02,   3.64816531e-02,
                  1.00000000e+00,   2.13147196e+02,   2.46322568e+02,
                  3.80716571e-01,   3.81016199e-01,   2.31623239e-01,
                  2.32146746e-01,   3.88189100e-01,   8.22054097e-02,
                  1.42397323e-01,   6.47453148e+01,   1.06040330e+02,
                  4.10780562e-01,   1.09259002e-01,   4.81308764e-01,
                  4.21328318e-02,   3.80592712e-01,   3.80919063e-01,
                  2.30589274e-01,   2.30140091e-01])
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} (494021, 32)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:}            duration     src\_bytes     dst\_bytes  wrong\_fragment        urgent  \textbackslash{}
         count  4.940210e+05  4.940210e+05  4.940210e+05    4.940210e+05  4.940210e+05   
         mean  -3.625574e-14 -1.320064e-14 -5.498890e-14   -6.073146e-15 -1.529804e-14   
         std    1.000001e+00  1.000001e+00  1.000001e+00    1.000001e+00  1.000001e+00   
         min   -6.779172e-02 -3.061686e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         25\%   -6.779172e-02 -3.016149e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         50\%   -6.779172e-02 -2.535486e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         75\%   -6.779172e-02 -2.017381e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         max    8.234740e+01  7.016400e+02  1.560110e+02    2.220663e+01  5.444371e+02   
         
                         hot  num\_failed\_logins  num\_compromised      num\_root  \textbackslash{}
         count  4.940210e+05       4.940210e+05     4.940210e+05  4.940210e+05   
         mean  -6.957988e-14      -8.038565e-14    -1.113045e-14 -1.364308e-14   
         std    1.000001e+00       1.000001e+00     1.000001e+00  1.000001e+00   
         min   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         25\%   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         50\%   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         75\%   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         max    3.831404e+01       3.221639e+02     4.915630e+02  4.933575e+02   
         
                num\_file\_creations            {\ldots}             dst\_host\_count  \textbackslash{}
         count        4.940210e+05            {\ldots}               4.940210e+05   
         mean         1.653658e-14            {\ldots}              -7.353653e-13   
         std          1.000001e+00            {\ldots}               1.000001e+00   
         min         -1.123208e-02            {\ldots}              -3.590542e+00   
         25\%         -1.123208e-02            {\ldots}               3.479668e-01   
         50\%         -1.123208e-02            {\ldots}               3.479668e-01   
         75\%         -1.123208e-02            {\ldots}               3.479668e-01   
         max          2.903977e+02            {\ldots}               3.479668e-01   
         
                dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  dst\_host\_diff\_srv\_rate  \textbackslash{}
         count        4.940210e+05            4.940210e+05            4.940210e+05   
         mean         1.953080e-13            3.799918e-13           -1.392772e-13   
         std          1.000001e+00            1.000001e+00            1.000001e+00   
         min         -1.779188e+00           -1.834994e+00           -2.828667e-01   
         25\%         -1.345391e+00           -8.368938e-01           -2.828667e-01   
         50\%          6.255576e-01            5.993962e-01           -2.828667e-01   
         75\%          6.255576e-01            5.993962e-01            8.323588e-02   
         max          6.255576e-01            5.993962e-01            8.869697e+00   
         
                dst\_host\_same\_src\_port\_rate  dst\_host\_srv\_diff\_host\_rate  \textbackslash{}
         count                 4.940210e+05                 4.940210e+05   
         mean                  7.581150e-13                 2.700207e-13   
         std                   1.000001e+00                 1.000001e+00   
         min                  -1.250621e+00                -1.586293e-01   
         25\%                  -1.250621e+00                -1.586293e-01   
         50\%                   8.270476e-01                -1.586293e-01   
         75\%                   8.270476e-01                -1.586293e-01   
         max                   8.270476e-01                 2.357583e+01   
         
                dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count          4.940210e+05              4.940210e+05          4.940210e+05   
         mean           2.263813e-13              3.603748e-13          6.990594e-13   
         std            1.000001e+00              1.000001e+00          1.000001e+00   
         min           -4.644176e-01             -4.632024e-01         -2.520395e-01   
         25\%           -4.644176e-01             -4.632024e-01         -2.520395e-01   
         50\%           -4.644176e-01             -4.632024e-01         -2.520395e-01   
         75\%           -4.644176e-01             -4.632024e-01         -2.520395e-01   
         max            2.163063e+00              2.162027e+00          4.084676e+00   
         
                dst\_host\_srv\_rerror\_rate  
         count              4.940210e+05  
         mean              -9.654619e-14  
         std                1.000001e+00  
         min               -2.494640e-01  
         25\%               -2.494640e-01  
         50\%               -2.494640e-01  
         75\%               -2.494640e-01  
         max                4.095715e+00  
         
         [8 rows x 32 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:}    duration  src\_bytes  dst\_bytes  wrong\_fragment    urgent       hot  \textbackslash{}
         0 -0.067792  -0.002879   0.138664        -0.04772 -0.002571 -0.044136   
         1 -0.067792  -0.002820  -0.011578        -0.04772 -0.002571 -0.044136   
         2 -0.067792  -0.002824   0.014179        -0.04772 -0.002571 -0.044136   
         3 -0.067792  -0.002840   0.014179        -0.04772 -0.002571 -0.044136   
         4 -0.067792  -0.002842   0.035214        -0.04772 -0.002571 -0.044136   
         5 -0.067792  -0.002842   0.035214        -0.04772 -0.002571 -0.044136   
         6 -0.067792  -0.002847   0.032429        -0.04772 -0.002571 -0.044136   
         7 -0.067792  -0.002901   0.097411        -0.04772 -0.002571 -0.044136   
         8 -0.067792  -0.002849  -0.021717        -0.04772 -0.002571 -0.044136   
         9 -0.067792  -0.002847  -0.002498        -0.04772 -0.002571  1.234470   
         
            num\_failed\_logins  num\_compromised  num\_root  num\_file\_creations  \textbackslash{}
         0          -0.009782        -0.005679  -0.00564           -0.011232   
         1          -0.009782        -0.005679  -0.00564           -0.011232   
         2          -0.009782        -0.005679  -0.00564           -0.011232   
         3          -0.009782        -0.005679  -0.00564           -0.011232   
         4          -0.009782        -0.005679  -0.00564           -0.011232   
         5          -0.009782        -0.005679  -0.00564           -0.011232   
         6          -0.009782        -0.005679  -0.00564           -0.011232   
         7          -0.009782        -0.005679  -0.00564           -0.011232   
         8          -0.009782        -0.005679  -0.00564           -0.011232   
         9          -0.009782        -0.005679  -0.00564           -0.011232   
         
                      {\ldots}             dst\_host\_count  dst\_host\_srv\_count  \textbackslash{}
         0            {\ldots}                  -3.451536           -1.694315   
         1            {\ldots}                  -3.297085           -1.600011   
         2            {\ldots}                  -3.142633           -1.505707   
         3            {\ldots}                  -2.988182           -1.411403   
         4            {\ldots}                  -2.833731           -1.317100   
         5            {\ldots}                  -2.679279           -1.222796   
         6            {\ldots}                  -3.575097           -1.128492   
         7            {\ldots}                  -3.420646           -1.034188   
         8            {\ldots}                  -3.466981           -0.939885   
         9            {\ldots}                  -3.466981           -0.845581   
         
            dst\_host\_same\_srv\_rate  dst\_host\_diff\_srv\_rate  \textbackslash{}
         0                0.599396               -0.282867   
         1                0.599396               -0.282867   
         2                0.599396               -0.282867   
         3                0.599396               -0.282867   
         4                0.599396               -0.282867   
         5                0.599396               -0.282867   
         6                0.599396               -0.282867   
         7                0.599396               -0.282867   
         8                0.599396               -0.282867   
         9                0.599396               -0.282867   
         
            dst\_host\_same\_src\_port\_rate  dst\_host\_srv\_diff\_host\_rate  \textbackslash{}
         0                    -1.022077                    -0.158629   
         1                    -1.146737                    -0.158629   
         2                    -1.188291                    -0.158629   
         3                    -1.188291                    -0.158629   
         4                    -1.209067                    -0.158629   
         5                    -1.209067                    -0.158629   
         6                     0.827048                     0.790749   
         7                    -1.063631                     0.790749   
         8                    -1.001301                     0.790749   
         9                    -1.001301                     1.028094   
         
            dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         0             -0.464418                 -0.463202              -0.25204   
         1             -0.464418                 -0.463202              -0.25204   
         2             -0.464418                 -0.463202              -0.25204   
         3             -0.464418                 -0.463202              -0.25204   
         4             -0.464418                 -0.463202              -0.25204   
         5             -0.464418                 -0.463202              -0.25204   
         6             -0.464418                 -0.463202              -0.25204   
         7             -0.464418                 -0.463202              -0.25204   
         8             -0.464418                 -0.463202              -0.25204   
         9             -0.464418                 -0.463202              -0.25204   
         
            dst\_host\_srv\_rerror\_rate  
         0                 -0.249464  
         1                 -0.249464  
         2                 -0.249464  
         3                 -0.249464  
         4                 -0.249464  
         5                 -0.249464  
         6                 -0.249464  
         7                 -0.249464  
         8                 -0.249464  
         9                 -0.249464  
         
         [10 rows x 32 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} (494021, 38)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:}            duration     src\_bytes     dst\_bytes  wrong\_fragment        urgent  \textbackslash{}
         count  4.940210e+05  4.940210e+05  4.940210e+05    4.940210e+05  4.940210e+05   
         mean  -3.625574e-14 -1.320064e-14 -5.498890e-14   -6.073146e-15 -1.529804e-14   
         std    1.000001e+00  1.000001e+00  1.000001e+00    1.000001e+00  1.000001e+00   
         min   -6.779172e-02 -3.061686e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         25\%   -6.779172e-02 -3.016149e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         50\%   -6.779172e-02 -2.535486e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         75\%   -6.779172e-02 -2.017381e-03 -2.628733e-02   -4.772019e-02 -2.571468e-03   
         max    8.234740e+01  7.016400e+02  1.560110e+02    2.220663e+01  5.444371e+02   
         
                         hot  num\_failed\_logins  num\_compromised      num\_root  \textbackslash{}
         count  4.940210e+05       4.940210e+05     4.940210e+05  4.940210e+05   
         mean  -6.957988e-14      -8.038565e-14    -1.113045e-14 -1.364308e-14   
         std    1.000001e+00       1.000001e+00     1.000001e+00  1.000001e+00   
         min   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         25\%   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         50\%   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         75\%   -4.413591e-02      -9.782185e-03    -5.678684e-03 -5.640012e-03   
         max    3.831404e+01       3.221639e+02     4.915630e+02  4.933575e+02   
         
                num\_file\_creations       {\ldots}        dst\_host\_serror\_rate  \textbackslash{}
         count        4.940210e+05       {\ldots}                4.940210e+05   
         mean         1.653658e-14       {\ldots}                2.263813e-13   
         std          1.000001e+00       {\ldots}                1.000001e+00   
         min         -1.123208e-02       {\ldots}               -4.644176e-01   
         25\%         -1.123208e-02       {\ldots}               -4.644176e-01   
         50\%         -1.123208e-02       {\ldots}               -4.644176e-01   
         75\%         -1.123208e-02       {\ldots}               -4.644176e-01   
         max          2.903977e+02       {\ldots}                2.163063e+00   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count              4.940210e+05          4.940210e+05   
         mean               3.603748e-13          6.990594e-13   
         std                1.000001e+00          1.000001e+00   
         min               -4.632024e-01         -2.520395e-01   
         25\%               -4.632024e-01         -2.520395e-01   
         50\%               -4.632024e-01         -2.520395e-01   
         75\%               -4.632024e-01         -2.520395e-01   
         max                2.162027e+00          4.084676e+00   
         
                dst\_host\_srv\_rerror\_rate           land      logged\_in     root\_shell  \textbackslash{}
         count              4.940210e+05  494021.000000  494021.000000  494021.000000   
         mean              -9.654619e-14       0.000045       0.148247       0.000111   
         std                1.000001e+00       0.006673       0.355345       0.010551   
         min               -2.494640e-01       0.000000       0.000000       0.000000   
         25\%               -2.494640e-01       0.000000       0.000000       0.000000   
         50\%               -2.494640e-01       0.000000       0.000000       0.000000   
         75\%               -2.494640e-01       0.000000       0.000000       0.000000   
         max                4.095715e+00       1.000000       1.000000       1.000000   
         
                 su\_attempted  is\_host\_login  is\_guest\_login  
         count  494021.000000       494021.0   494021.000000  
         mean        0.000036            0.0        0.001387  
         std         0.007793            0.0        0.037211  
         min         0.000000            0.0        0.000000  
         25\%         0.000000            0.0        0.000000  
         50\%         0.000000            0.0        0.000000  
         75\%         0.000000            0.0        0.000000  
         max         2.000000            0.0        1.000000  
         
         [8 rows x 38 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:}    duration  src\_bytes  dst\_bytes  wrong\_fragment    urgent       hot  \textbackslash{}
         0 -0.067792  -0.002879   0.138664        -0.04772 -0.002571 -0.044136   
         1 -0.067792  -0.002820  -0.011578        -0.04772 -0.002571 -0.044136   
         2 -0.067792  -0.002824   0.014179        -0.04772 -0.002571 -0.044136   
         3 -0.067792  -0.002840   0.014179        -0.04772 -0.002571 -0.044136   
         4 -0.067792  -0.002842   0.035214        -0.04772 -0.002571 -0.044136   
         5 -0.067792  -0.002842   0.035214        -0.04772 -0.002571 -0.044136   
         6 -0.067792  -0.002847   0.032429        -0.04772 -0.002571 -0.044136   
         7 -0.067792  -0.002901   0.097411        -0.04772 -0.002571 -0.044136   
         8 -0.067792  -0.002849  -0.021717        -0.04772 -0.002571 -0.044136   
         9 -0.067792  -0.002847  -0.002498        -0.04772 -0.002571  1.234470   
         
            num\_failed\_logins  num\_compromised  num\_root  num\_file\_creations  \textbackslash{}
         0          -0.009782        -0.005679  -0.00564           -0.011232   
         1          -0.009782        -0.005679  -0.00564           -0.011232   
         2          -0.009782        -0.005679  -0.00564           -0.011232   
         3          -0.009782        -0.005679  -0.00564           -0.011232   
         4          -0.009782        -0.005679  -0.00564           -0.011232   
         5          -0.009782        -0.005679  -0.00564           -0.011232   
         6          -0.009782        -0.005679  -0.00564           -0.011232   
         7          -0.009782        -0.005679  -0.00564           -0.011232   
         8          -0.009782        -0.005679  -0.00564           -0.011232   
         9          -0.009782        -0.005679  -0.00564           -0.011232   
         
                 {\ldots}        dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  \textbackslash{}
         0       {\ldots}                   -0.464418                 -0.463202   
         1       {\ldots}                   -0.464418                 -0.463202   
         2       {\ldots}                   -0.464418                 -0.463202   
         3       {\ldots}                   -0.464418                 -0.463202   
         4       {\ldots}                   -0.464418                 -0.463202   
         5       {\ldots}                   -0.464418                 -0.463202   
         6       {\ldots}                   -0.464418                 -0.463202   
         7       {\ldots}                   -0.464418                 -0.463202   
         8       {\ldots}                   -0.464418                 -0.463202   
         9       {\ldots}                   -0.464418                 -0.463202   
         
            dst\_host\_rerror\_rate  dst\_host\_srv\_rerror\_rate  land  logged\_in  \textbackslash{}
         0              -0.25204                 -0.249464     0          1   
         1              -0.25204                 -0.249464     0          1   
         2              -0.25204                 -0.249464     0          1   
         3              -0.25204                 -0.249464     0          1   
         4              -0.25204                 -0.249464     0          1   
         5              -0.25204                 -0.249464     0          1   
         6              -0.25204                 -0.249464     0          1   
         7              -0.25204                 -0.249464     0          1   
         8              -0.25204                 -0.249464     0          1   
         9              -0.25204                 -0.249464     0          1   
         
            root\_shell  su\_attempted  is\_host\_login  is\_guest\_login  
         0           0             0              0               0  
         1           0             0              0               0  
         2           0             0              0               0  
         3           0             0              0               0  
         4           0             0              0               0  
         5           0             0              0               0  
         6           0             0              0               0  
         7           0             0              0               0  
         8           0             0              0               0  
         9           0             0              0               0  
         
         [10 rows x 38 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}Applying the same transformations on the test dataset}
         
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}var} \PY{o}{=} \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}var}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}var}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}var}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n+nb}{type}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}var}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Creating a list of the discrete valued columns (mentioned in the documentation for the dataset) and removing them from the scaling dataset}
         \PY{n}{cont\PYZus{}labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{src\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wrong\PYZus{}fragment}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{urgent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}failed\PYZus{}logins}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}compromised}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}root}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}file\PYZus{}creations}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}shells}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}access\PYZus{}files}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}outbound\PYZus{}cmds}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}src\PYZus{}port\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{other\PYZus{}labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{land}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logged\PYZus{}in}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{root\PYZus{}shell}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{su\PYZus{}attempted}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}host\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}guest\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}forscale} \PY{o}{=} \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{n}{cont\PYZus{}labels}\PY{p}{]}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}forscale}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}forscale}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}others} \PY{o}{=} \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{n}{other\PYZus{}labels}\PY{p}{]}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}others}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}others}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}scaling the test dataset}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data} \PY{o}{=} \PY{n}{train\PYZus{}scaler}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}forscale}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{cont\PYZus{}labels}\PY{p}{)}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled1}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled1}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}adding the binary valued variable columns}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled1}\PY{p}{,}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}others}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{o}{.}\PY{n}{shape}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
         \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} (311029, 38)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}             duration     src\_bytes     dst\_bytes           land  \textbackslash{}
         count  311029.000000  3.110290e+05  3.110290e+05  311029.000000   
         mean       17.902736  1.731702e+03  7.479937e+02       0.000029   
         std       407.644400  1.276567e+05  1.612018e+04       0.005379   
         min         0.000000  0.000000e+00  0.000000e+00       0.000000   
         25\%         0.000000  1.050000e+02  0.000000e+00       0.000000   
         50\%         0.000000  5.200000e+02  0.000000e+00       0.000000   
         75\%         0.000000  1.032000e+03  0.000000e+00       0.000000   
         max     57715.000000  6.282565e+07  5.203179e+06       1.000000   
         
                wrong\_fragment         urgent            hot  num\_failed\_logins  \textbackslash{}
         count   311029.000000  311029.000000  311029.000000      311029.000000   
         mean         0.000762       0.000051       0.014677           0.002363   
         std          0.040367       0.009821       0.312068           0.049990   
         min          0.000000       0.000000       0.000000           0.000000   
         25\%          0.000000       0.000000       0.000000           0.000000   
         50\%          0.000000       0.000000       0.000000           0.000000   
         75\%          0.000000       0.000000       0.000000           0.000000   
         max          3.000000       3.000000     101.000000           4.000000   
         
                    logged\_in  num\_compromised            {\ldots}             \textbackslash{}
         count  311029.000000    311029.000000            {\ldots}              
         mean        0.172476         0.011243            {\ldots}              
         std         0.377794         1.958325            {\ldots}              
         min         0.000000         0.000000            {\ldots}              
         25\%         0.000000         0.000000            {\ldots}              
         50\%         0.000000         0.000000            {\ldots}              
         75\%         0.000000         0.000000            {\ldots}              
         max         1.000000       796.000000            {\ldots}              
         
                dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         count   311029.000000       311029.000000           311029.000000   
         mean       235.282681          199.193914                0.793494   
         std         60.913298          100.306470                0.387090   
         min          0.000000            0.000000                0.000000   
         25\%        255.000000          244.000000                0.970000   
         50\%        255.000000          255.000000                1.000000   
         75\%        255.000000          255.000000                1.000000   
         max        255.000000          255.000000                1.000000   
         
                dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         count           311029.000000                311029.000000   
         mean                 0.024953                     0.547919   
         std                  0.096003                     0.491963   
         min                  0.000000                     0.000000   
         25\%                  0.000000                     0.000000   
         50\%                  0.000000                     1.000000   
         75\%                  0.010000                     1.000000   
         max                  1.000000                     1.000000   
         
                dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         count                311029.000000         311029.000000   
         mean                      0.004566              0.058764   
         std                       0.035773              0.231296   
         min                       0.000000              0.000000   
         25\%                       0.000000              0.000000   
         50\%                       0.000000              0.000000   
         75\%                       0.000000              0.000000   
         max                       1.000000              1.000000   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count             311029.000000         311029.000000   
         mean                   0.058791              0.142659   
         std                    0.232997              0.344380   
         min                    0.000000              0.000000   
         25\%                    0.000000              0.000000   
         50\%                    0.000000              0.000000   
         75\%                    0.000000              0.000000   
         max                    1.000000              1.000000   
         
                dst\_host\_srv\_rerror\_rate  
         count             311029.000000  
         mean                   0.141693  
         std                    0.346573  
         min                    0.000000  
         25\%                    0.000000  
         50\%                    0.000000  
         75\%                    0.000000  
         max                    1.000000  
         
         [8 rows x 38 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}    duration  src\_bytes  dst\_bytes  land  wrong\_fragment  urgent  hot  \textbackslash{}
         0         0        105        146     0               0       0    0   
         1         0        105        146     0               0       0    0   
         2         0        105        146     0               0       0    0   
         3         0        105        146     0               0       0    0   
         4         0        105        146     0               0       0    0   
         5         0        105        146     0               0       0    0   
         6         0         29          0     0               0       0    0   
         7         0        105        146     0               0       0    0   
         8         0        105        146     0               0       0    0   
         9         0        223        185     0               0       0    0   
         
            num\_failed\_logins  logged\_in  num\_compromised            {\ldots}             \textbackslash{}
         0                  0          0                0            {\ldots}              
         1                  0          0                0            {\ldots}              
         2                  0          0                0            {\ldots}              
         3                  0          0                0            {\ldots}              
         4                  0          0                0            {\ldots}              
         5                  0          0                0            {\ldots}              
         6                  0          0                0            {\ldots}              
         7                  0          0                0            {\ldots}              
         8                  0          0                0            {\ldots}              
         9                  0          1                0            {\ldots}              
         
            dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         0             255                 254                    1.00   
         1             255                 254                    1.00   
         2             255                 254                    1.00   
         3             255                 254                    1.00   
         4             255                 254                    1.00   
         5             255                 255                    1.00   
         6              10                   3                    0.30   
         7             255                 253                    0.99   
         8             255                 254                    1.00   
         9              71                 255                    1.00   
         
            dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         0                    0.01                         0.00   
         1                    0.01                         0.00   
         2                    0.01                         0.00   
         3                    0.01                         0.00   
         4                    0.01                         0.01   
         5                    0.00                         0.01   
         6                    0.30                         0.30   
         7                    0.01                         0.00   
         8                    0.01                         0.00   
         9                    0.00                         0.01   
         
            dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         0                         0.00                   0.0   
         1                         0.00                   0.0   
         2                         0.00                   0.0   
         3                         0.00                   0.0   
         4                         0.00                   0.0   
         5                         0.00                   0.0   
         6                         0.00                   0.0   
         7                         0.00                   0.0   
         8                         0.00                   0.0   
         9                         0.01                   0.0   
         
            dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  dst\_host\_srv\_rerror\_rate  
         0                       0.0                   0.0                       0.0  
         1                       0.0                   0.0                       0.0  
         2                       0.0                   0.0                       0.0  
         3                       0.0                   0.0                       0.0  
         4                       0.0                   0.0                       0.0  
         5                       0.0                   0.0                       0.0  
         6                       0.0                   0.0                       0.0  
         7                       0.0                   0.0                       0.0  
         8                       0.0                   0.0                       0.0  
         9                       0.0                   0.0                       0.0  
         
         [10 rows x 38 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} (311029, 32)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}             duration     src\_bytes     dst\_bytes  wrong\_fragment  \textbackslash{}
         count  311029.000000  3.110290e+05  3.110290e+05   311029.000000   
         mean       17.902736  1.731702e+03  7.479937e+02        0.000762   
         std       407.644400  1.276567e+05  1.612018e+04        0.040367   
         min         0.000000  0.000000e+00  0.000000e+00        0.000000   
         25\%         0.000000  1.050000e+02  0.000000e+00        0.000000   
         50\%         0.000000  5.200000e+02  0.000000e+00        0.000000   
         75\%         0.000000  1.032000e+03  0.000000e+00        0.000000   
         max     57715.000000  6.282565e+07  5.203179e+06        3.000000   
         
                       urgent            hot  num\_failed\_logins  num\_compromised  \textbackslash{}
         count  311029.000000  311029.000000      311029.000000    311029.000000   
         mean        0.000051       0.014677           0.002363         0.011243   
         std         0.009821       0.312068           0.049990         1.958325   
         min         0.000000       0.000000           0.000000         0.000000   
         25\%         0.000000       0.000000           0.000000         0.000000   
         50\%         0.000000       0.000000           0.000000         0.000000   
         75\%         0.000000       0.000000           0.000000         0.000000   
         max         3.000000     101.000000           4.000000       796.000000   
         
                     num\_root  num\_file\_creations            {\ldots}             \textbackslash{}
         count  311029.000000       311029.000000            {\ldots}              
         mean        0.008359            0.000958            {\ldots}              
         std         2.165196            0.193119            {\ldots}              
         min         0.000000            0.000000            {\ldots}              
         25\%         0.000000            0.000000            {\ldots}              
         50\%         0.000000            0.000000            {\ldots}              
         75\%         0.000000            0.000000            {\ldots}              
         max       878.000000          100.000000            {\ldots}              
         
                dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         count   311029.000000       311029.000000           311029.000000   
         mean       235.282681          199.193914                0.793494   
         std         60.913298          100.306470                0.387090   
         min          0.000000            0.000000                0.000000   
         25\%        255.000000          244.000000                0.970000   
         50\%        255.000000          255.000000                1.000000   
         75\%        255.000000          255.000000                1.000000   
         max        255.000000          255.000000                1.000000   
         
                dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         count           311029.000000                311029.000000   
         mean                 0.024953                     0.547919   
         std                  0.096003                     0.491963   
         min                  0.000000                     0.000000   
         25\%                  0.000000                     0.000000   
         50\%                  0.000000                     1.000000   
         75\%                  0.010000                     1.000000   
         max                  1.000000                     1.000000   
         
                dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         count                311029.000000         311029.000000   
         mean                      0.004566              0.058764   
         std                       0.035773              0.231296   
         min                       0.000000              0.000000   
         25\%                       0.000000              0.000000   
         50\%                       0.000000              0.000000   
         75\%                       0.000000              0.000000   
         max                       1.000000              1.000000   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count             311029.000000         311029.000000   
         mean                   0.058791              0.142659   
         std                    0.232997              0.344380   
         min                    0.000000              0.000000   
         25\%                    0.000000              0.000000   
         50\%                    0.000000              0.000000   
         75\%                    0.000000              0.000000   
         max                    1.000000              1.000000   
         
                dst\_host\_srv\_rerror\_rate  
         count             311029.000000  
         mean                   0.141693  
         std                    0.346573  
         min                    0.000000  
         25\%                    0.000000  
         50\%                    0.000000  
         75\%                    0.000000  
         max                    1.000000  
         
         [8 rows x 32 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} (311029, 6)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}                 land      logged\_in     root\_shell   su\_attempted  \textbackslash{}
         count  311029.000000  311029.000000  311029.000000  311029.000000   
         mean        0.000029       0.172476       0.000199       0.000023   
         std         0.005379       0.377794       0.014117       0.005947   
         min         0.000000       0.000000       0.000000       0.000000   
         25\%         0.000000       0.000000       0.000000       0.000000   
         50\%         0.000000       0.000000       0.000000       0.000000   
         75\%         0.000000       0.000000       0.000000       0.000000   
         max         1.000000       1.000000       1.000000       2.000000   
         
                is\_host\_login  is\_guest\_login  
         count  311029.000000   311029.000000  
         mean        0.000039        0.002424  
         std         0.006211        0.049177  
         min         0.000000        0.000000  
         25\%         0.000000        0.000000  
         50\%         0.000000        0.000000  
         75\%         0.000000        0.000000  
         max         1.000000        1.000000  
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} (311029, 32)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}             duration      src\_bytes      dst\_bytes  wrong\_fragment  \textbackslash{}
         count  311029.000000  311029.000000  311029.000000   311029.000000   
         mean       -0.042496      -0.001309      -0.003648       -0.042068   
         std         0.575976       0.129179       0.487899        0.299447   
         min        -0.067792      -0.003062      -0.026287       -0.047720   
         25\%        -0.067792      -0.002955      -0.026287       -0.047720   
         50\%        -0.067792      -0.002535      -0.026287       -0.047720   
         75\%        -0.067792      -0.002017      -0.026287       -0.047720   
         max        81.479854      63.571681     157.455071       22.206629   
         
                       urgent            hot  num\_failed\_logins  num\_compromised  \textbackslash{}
         count  311029.000000  311029.000000      311029.000000    311029.000000   
         mean        0.006764      -0.025370           0.142485         0.000573   
         std         1.782311       0.399013           3.221101         1.088972   
         min        -0.002571      -0.044136          -0.009782        -0.005679   
         25\%        -0.002571      -0.044136          -0.009782        -0.005679   
         50\%        -0.002571      -0.044136          -0.009782        -0.005679   
         75\%        -0.002571      -0.044136          -0.009782        -0.005679   
         max       544.437104     129.095065         257.729132       442.628578   
         
                     num\_root  num\_file\_creations            {\ldots}             \textbackslash{}
         count  311029.000000       311029.000000            {\ldots}              
         mean       -0.001487           -0.001295            {\ldots}              
         std         1.075758            2.002976            {\ldots}              
         min        -0.005640           -0.011232            {\ldots}              
         25\%        -0.005640           -0.011232            {\ldots}              
         50\%        -0.005640           -0.011232            {\ldots}              
         75\%        -0.005640           -0.011232            {\ldots}              
         max       436.220770         1037.163376            {\ldots}              
         
                dst\_host\_count  dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  \textbackslash{}
         count   311029.000000       311029.000000           311029.000000   
         mean         0.043430            0.099285                0.096681   
         std          0.940814            0.945928                0.942328   
         min         -3.590542           -1.779188               -1.834994   
         25\%          0.347967            0.521823                0.526364   
         50\%          0.347967            0.625558                0.599396   
         75\%          0.347967            0.625558                0.599396   
         max          0.347967            0.625558                0.599396   
         
                dst\_host\_diff\_srv\_rate  dst\_host\_same\_src\_port\_rate  \textbackslash{}
         count           311029.000000                311029.000000   
         mean                -0.054486                    -0.112228   
         std                  0.878676                     1.022135   
         min                 -0.282867                    -1.250621   
         25\%                 -0.282867                    -1.250621   
         50\%                 -0.282867                     0.827048   
         75\%                 -0.191341                     0.827048   
         max                  8.869697                     0.827048   
         
                dst\_host\_srv\_diff\_host\_rate  dst\_host\_serror\_rate  \textbackslash{}
         count                311029.000000         311029.000000   
         mean                     -0.050252             -0.310016   
         std                       0.849060              0.607725   
         min                      -0.158629             -0.464418   
         25\%                      -0.158629             -0.464418   
         50\%                      -0.158629             -0.464418   
         75\%                      -0.158629             -0.464418   
         max                      23.575830              2.163063   
         
                dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count             311029.000000         311029.000000   
         mean                  -0.308862              0.366631   
         std                    0.611671              1.493477   
         min                   -0.463202             -0.252040   
         25\%                   -0.463202             -0.252040   
         50\%                   -0.463202             -0.252040   
         75\%                   -0.463202             -0.252040   
         max                    2.162027              4.084676   
         
                dst\_host\_srv\_rerror\_rate  
         count             311029.000000  
         mean                   0.366219  
         std                    1.505923  
         min                   -0.249464  
         25\%                   -0.249464  
         50\%                   -0.249464  
         75\%                   -0.249464  
         max                    4.095715  
         
         [8 rows x 32 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}    duration  src\_bytes  dst\_bytes  wrong\_fragment    urgent       hot  \textbackslash{}
         0 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         1 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         2 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         3 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         4 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         5 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         6 -0.067792  -0.003032  -0.026287        -0.04772 -0.002571 -0.044136   
         7 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         8 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         9 -0.067792  -0.002836  -0.020688        -0.04772 -0.002571 -0.044136   
         
            num\_failed\_logins  num\_compromised  num\_root  num\_file\_creations  \textbackslash{}
         0          -0.009782        -0.005679  -0.00564           -0.011232   
         1          -0.009782        -0.005679  -0.00564           -0.011232   
         2          -0.009782        -0.005679  -0.00564           -0.011232   
         3          -0.009782        -0.005679  -0.00564           -0.011232   
         4          -0.009782        -0.005679  -0.00564           -0.011232   
         5          -0.009782        -0.005679  -0.00564           -0.011232   
         6          -0.009782        -0.005679  -0.00564           -0.011232   
         7          -0.009782        -0.005679  -0.00564           -0.011232   
         8          -0.009782        -0.005679  -0.00564           -0.011232   
         9          -0.009782        -0.005679  -0.00564           -0.011232   
         
                      {\ldots}             dst\_host\_count  dst\_host\_srv\_count  \textbackslash{}
         0            {\ldots}                   0.347967            0.616127   
         1            {\ldots}                   0.347967            0.616127   
         2            {\ldots}                   0.347967            0.616127   
         3            {\ldots}                   0.347967            0.616127   
         4            {\ldots}                   0.347967            0.616127   
         5            {\ldots}                   0.347967            0.625558   
         6            {\ldots}                  -3.436091           -1.750897   
         7            {\ldots}                   0.347967            0.606697   
         8            {\ldots}                   0.347967            0.616127   
         9            {\ldots}                  -2.493938            0.625558   
         
            dst\_host\_same\_srv\_rate  dst\_host\_diff\_srv\_rate  \textbackslash{}
         0                0.599396               -0.191341   
         1                0.599396               -0.191341   
         2                0.599396               -0.191341   
         3                0.599396               -0.191341   
         4                0.599396               -0.191341   
         5                0.599396               -0.282867   
         6               -1.104677                2.462903   
         7                0.575052               -0.191341   
         8                0.599396               -0.191341   
         9                0.599396               -0.282867   
         
            dst\_host\_same\_src\_port\_rate  dst\_host\_srv\_diff\_host\_rate  \textbackslash{}
         0                    -1.250621                    -0.158629   
         1                    -1.250621                    -0.158629   
         2                    -1.250621                    -0.158629   
         3                    -1.250621                    -0.158629   
         4                    -1.229844                    -0.158629   
         5                    -1.229844                    -0.158629   
         6                    -0.627320                    -0.158629   
         7                    -1.250621                    -0.158629   
         8                    -1.250621                    -0.158629   
         9                    -1.229844                     0.078715   
         
            dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         0             -0.464418                 -0.463202              -0.25204   
         1             -0.464418                 -0.463202              -0.25204   
         2             -0.464418                 -0.463202              -0.25204   
         3             -0.464418                 -0.463202              -0.25204   
         4             -0.464418                 -0.463202              -0.25204   
         5             -0.464418                 -0.463202              -0.25204   
         6             -0.464418                 -0.463202              -0.25204   
         7             -0.464418                 -0.463202              -0.25204   
         8             -0.464418                 -0.463202              -0.25204   
         9             -0.464418                 -0.463202              -0.25204   
         
            dst\_host\_srv\_rerror\_rate  
         0                 -0.249464  
         1                 -0.249464  
         2                 -0.249464  
         3                 -0.249464  
         4                 -0.249464  
         5                 -0.249464  
         6                 -0.249464  
         7                 -0.249464  
         8                 -0.249464  
         9                 -0.249464  
         
         [10 rows x 32 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} (311029, 38)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}             duration      src\_bytes      dst\_bytes  wrong\_fragment  \textbackslash{}
         count  311029.000000  311029.000000  311029.000000   311029.000000   
         mean       -0.042496      -0.001309      -0.003648       -0.042068   
         std         0.575976       0.129179       0.487899        0.299447   
         min        -0.067792      -0.003062      -0.026287       -0.047720   
         25\%        -0.067792      -0.002955      -0.026287       -0.047720   
         50\%        -0.067792      -0.002535      -0.026287       -0.047720   
         75\%        -0.067792      -0.002017      -0.026287       -0.047720   
         max        81.479854      63.571681     157.455071       22.206629   
         
                       urgent            hot  num\_failed\_logins  num\_compromised  \textbackslash{}
         count  311029.000000  311029.000000      311029.000000    311029.000000   
         mean        0.006764      -0.025370           0.142485         0.000573   
         std         1.782311       0.399013           3.221101         1.088972   
         min        -0.002571      -0.044136          -0.009782        -0.005679   
         25\%        -0.002571      -0.044136          -0.009782        -0.005679   
         50\%        -0.002571      -0.044136          -0.009782        -0.005679   
         75\%        -0.002571      -0.044136          -0.009782        -0.005679   
         max       544.437104     129.095065         257.729132       442.628578   
         
                     num\_root  num\_file\_creations       {\ldots}        \textbackslash{}
         count  311029.000000       311029.000000       {\ldots}         
         mean       -0.001487           -0.001295       {\ldots}         
         std         1.075758            2.002976       {\ldots}         
         min        -0.005640           -0.011232       {\ldots}         
         25\%        -0.005640           -0.011232       {\ldots}         
         50\%        -0.005640           -0.011232       {\ldots}         
         75\%        -0.005640           -0.011232       {\ldots}         
         max       436.220770         1037.163376       {\ldots}         
         
                dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
         count         311029.000000             311029.000000         311029.000000   
         mean              -0.310016                 -0.308862              0.366631   
         std                0.607725                  0.611671              1.493477   
         min               -0.464418                 -0.463202             -0.252040   
         25\%               -0.464418                 -0.463202             -0.252040   
         50\%               -0.464418                 -0.463202             -0.252040   
         75\%               -0.464418                 -0.463202             -0.252040   
         max                2.163063                  2.162027              4.084676   
         
                dst\_host\_srv\_rerror\_rate           land      logged\_in     root\_shell  \textbackslash{}
         count             311029.000000  311029.000000  311029.000000  311029.000000   
         mean                   0.366219       0.000029       0.172476       0.000199   
         std                    1.505923       0.005379       0.377794       0.014117   
         min                   -0.249464       0.000000       0.000000       0.000000   
         25\%                   -0.249464       0.000000       0.000000       0.000000   
         50\%                   -0.249464       0.000000       0.000000       0.000000   
         75\%                   -0.249464       0.000000       0.000000       0.000000   
         max                    4.095715       1.000000       1.000000       1.000000   
         
                 su\_attempted  is\_host\_login  is\_guest\_login  
         count  311029.000000  311029.000000   311029.000000  
         mean        0.000023       0.000039        0.002424  
         std         0.005947       0.006211        0.049177  
         min         0.000000       0.000000        0.000000  
         25\%         0.000000       0.000000        0.000000  
         50\%         0.000000       0.000000        0.000000  
         75\%         0.000000       0.000000        0.000000  
         max         2.000000       1.000000        1.000000  
         
         [8 rows x 38 columns]
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}    duration  src\_bytes  dst\_bytes  wrong\_fragment    urgent       hot  \textbackslash{}
         0 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         1 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         2 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         3 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         4 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         5 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         6 -0.067792  -0.003032  -0.026287        -0.04772 -0.002571 -0.044136   
         7 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         8 -0.067792  -0.002955  -0.021868        -0.04772 -0.002571 -0.044136   
         9 -0.067792  -0.002836  -0.020688        -0.04772 -0.002571 -0.044136   
         
            num\_failed\_logins  num\_compromised  num\_root  num\_file\_creations  \textbackslash{}
         0          -0.009782        -0.005679  -0.00564           -0.011232   
         1          -0.009782        -0.005679  -0.00564           -0.011232   
         2          -0.009782        -0.005679  -0.00564           -0.011232   
         3          -0.009782        -0.005679  -0.00564           -0.011232   
         4          -0.009782        -0.005679  -0.00564           -0.011232   
         5          -0.009782        -0.005679  -0.00564           -0.011232   
         6          -0.009782        -0.005679  -0.00564           -0.011232   
         7          -0.009782        -0.005679  -0.00564           -0.011232   
         8          -0.009782        -0.005679  -0.00564           -0.011232   
         9          -0.009782        -0.005679  -0.00564           -0.011232   
         
                 {\ldots}        dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  \textbackslash{}
         0       {\ldots}                   -0.464418                 -0.463202   
         1       {\ldots}                   -0.464418                 -0.463202   
         2       {\ldots}                   -0.464418                 -0.463202   
         3       {\ldots}                   -0.464418                 -0.463202   
         4       {\ldots}                   -0.464418                 -0.463202   
         5       {\ldots}                   -0.464418                 -0.463202   
         6       {\ldots}                   -0.464418                 -0.463202   
         7       {\ldots}                   -0.464418                 -0.463202   
         8       {\ldots}                   -0.464418                 -0.463202   
         9       {\ldots}                   -0.464418                 -0.463202   
         
            dst\_host\_rerror\_rate  dst\_host\_srv\_rerror\_rate  land  logged\_in  \textbackslash{}
         0              -0.25204                 -0.249464     0          0   
         1              -0.25204                 -0.249464     0          0   
         2              -0.25204                 -0.249464     0          0   
         3              -0.25204                 -0.249464     0          0   
         4              -0.25204                 -0.249464     0          0   
         5              -0.25204                 -0.249464     0          0   
         6              -0.25204                 -0.249464     0          0   
         7              -0.25204                 -0.249464     0          0   
         8              -0.25204                 -0.249464     0          0   
         9              -0.25204                 -0.249464     0          1   
         
            root\_shell  su\_attempted  is\_host\_login  is\_guest\_login  
         0           0             0              0               0  
         1           0             0              0               0  
         2           0             0              0               0  
         3           0             0              0               0  
         4           0             0              0               0  
         5           0             0              0               0  
         6           0             0              0               0  
         7           0             0              0               0  
         8           0             0              0               0  
         9           0             0              0               0  
         
         [10 rows x 38 columns]
\end{Verbatim}
            
    \subsubsection{Data Analysis}\label{data-analysis}

Now we use the final datasets to train and run models based on the
following algorithms and evaluate the best one for detection and
prediction purposes: - Logistic Regression - K-Nearest Neighbors -
Support Vector Machine - Random Forest - Neural Networks - Ensemble
Modeling - Unsupervised Learning - Clustering

Since there are several different attack types mentioned in the
"attack\_type" label, we first classify them into "normal" and "bad" (as
done in the Data Exploration section) and try to develop a model that
detects "bad" logs (majority of them being DoS attacks) in the test
dataset. We also implement multi-class detection for these models as
well.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{c+c1}{\PYZsh{}Importing the required packages}
         
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsClassifier}
         \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k}{import} \PY{n}{stats}
         \PY{k+kn}{import} \PY{n+nn}{pylab} \PY{k}{as} \PY{n+nn}{pl}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{SVC}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{KMeans}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{BaggingClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neural\PYZus{}network} \PY{k}{import} \PY{n}{MLPClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{VotingClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{tree}
\end{Verbatim}


    \subsubsection{Logistic Regression}\label{logistic-regression}

We use a logistic regression model trained on the training dataset to
predict "normal" and "bad" as well as multi-class labels for the test
dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{c+c1}{\PYZsh{}Creating the \PYZdq{}normal\PYZdq{} and \PYZdq{}bad\PYZdq{} labels for test dataset as well}
          \PY{n}{attack\PYZus{}labs\PYZus{}test} \PY{o}{=} \PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}mod}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
          \PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{[}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{o}{!=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{normal.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bad.}\PY{l+s+s1}{\PYZsq{}}
          \PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Logistic Regression Model \PYZhy{}\PYZhy{} 2 labels}
          \PY{n}{logrmodel} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{)}
          \PY{n}{logrmodel}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs}\PY{p}{)}
          \PY{n}{log\PYZus{}preds} \PY{o}{=} \PY{n}{logrmodel}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{log\PYZus{}preds}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Logistic Regression Model \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
          \PY{n}{logrmodel1} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{n}{solver}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{multi\PYZus{}class}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ovr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logrmodel1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{)}
          \PY{n}{log\PYZus{}preds1} \PY{o}{=} \PY{n}{logrmodel1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{log\PYZus{}preds1}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Calculating test metrics to evaluate the model \PYZhy{}\PYZhy{} 2 labels}
          \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{log\PYZus{}preds}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{log\PYZus{}preds}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{log\PYZus{}preds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{log\PYZus{}preds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{log\PYZus{}preds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{log\PYZus{}preds}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
          \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{log\PYZus{}preds}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
          
          
          \PY{c+c1}{\PYZsh{}Calculating test metrics to evaluate the model \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
          \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{log\PYZus{}preds1}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{log\PYZus{}preds1}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{log\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{log\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{log\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{log\PYZus{}preds1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
          \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{log\PYZus{}preds1}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}107}]:} bad.       250436
          normal.     60593
          Name: attack\_type, dtype: int64
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}107}]:} LogisticRegression(C=0.01, class\_weight=None, dual=False, fit\_intercept=True,
                    intercept\_scaling=1, max\_iter=100, multi\_class='ovr', n\_jobs=1,
                    penalty='l2', random\_state=None, solver='liblinear', tol=0.0001,
                    verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}Neha Rawat\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}linear\_model\textbackslash{}sag.py:326: ConvergenceWarning: The max\_iter was reached which means the coef\_ did not converge
  "the coef\_ did not converge", ConvergenceWarning)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}107}]:} LogisticRegression(C=0.01, class\_weight=None, dual=False, fit\_intercept=True,
                    intercept\_scaling=1, max\_iter=100, multi\_class='ovr', n\_jobs=1,
                    penalty='l2', random\_state=None, solver='sag', tol=0.0001,
                    verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']
[[225627  24809]
 [   994  59599]]
0.917039890171
0.942266115551
0.850848092029
0.883980813408

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}107}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_29_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99561382  0.70608236]
recall: [ 0.90093677  0.98359546]
fscore: [ 0.94591212  0.8220495 ]
support: [250436  60593]
[[222372      0      0   7447     34]
 [     5     23      0  16149     12]
 [    49      1      6    169      3]
 [   790     26      1  59699     77]
 [   200      0      0   1342   2624]]
0.915425892762
0.522059243356
0.794119922402
0.52301673276

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}107}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_29_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.9953271   0.46        0.85714286  0.70394783  0.95418182]
recall: [ 0.96745311  0.00142072  0.02631579  0.98524582  0.62986078]
fscore: [ 0.98119218  0.00283269  0.05106383  0.82117484  0.75882013]
support: [229853  16189    228  60593   4166]

    \end{Verbatim}

    We see that the accuracy (91.70 percent) and F1 scores (88.39 percent)
for 2-label predictions are good enough. Through the
precision\_recall\_fscore\_support matrix we can also see that correct
prediction of "bad" labels is higher, due to higher proportion of these
labels in the test as well as training data. When we try to fit a
multi-class problem using logistic regression, we observe that the
recall for "R2L" and "U2R" labels is very less (due to small proportion
of these labels in the training dataset), whereas predictions for DOS
and "normal" labels is quite good. Therefore, we will proceed to try
other algorithms to try and achieve better and more balanced prediction
scores.

    \subsubsection{K-Nearest Neighbors}\label{k-nearest-neighbors}

We use a K-Nearest Neighbors model (with k=5 and Manhattan Distance
Metric) trained on the training dataset to predict "normal" and "bad" as
well as multi-class labels for the test dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{}K\PYZhy{}Nearest Neighbors}
         \PY{c+c1}{\PYZsh{}We run the K\PYZhy{}nearest neighbors model for k = 5}
         \PY{c+c1}{\PYZsh{}Takes a lot of time \PYZhy{}\PYZhy{} around two hours}
         
         \PY{c+c1}{\PYZsh{}K=5 \PYZhy{}\PYZhy{} 2 labels}
         \PY{n}{knn\PYZus{}mod1} \PY{o}{=} \PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{n}{n\PYZus{}neighbors} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{algorithm} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ball\PYZus{}tree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{leaf\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{,} \PY{n}{metric}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{manhattan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)} 
         \PY{n}{knn\PYZus{}mod1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs}\PY{p}{)}
         \PY{n}{knn\PYZus{}preds1} \PY{o}{=} \PY{n}{knn\PYZus{}mod1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{knn\PYZus{}preds1}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Multi\PYZhy{}labels}
         \PY{n}{knn\PYZus{}mod2} \PY{o}{=} \PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{n}{n\PYZus{}neighbors} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{algorithm} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ball\PYZus{}tree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{leaf\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{,} \PY{n}{metric}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{manhattan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)} 
         \PY{n}{knn\PYZus{}mod2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{)}
         \PY{n}{knn\PYZus{}preds2} \PY{o}{=} \PY{n}{knn\PYZus{}mod2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{knn\PYZus{}preds2}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:} KNeighborsClassifier(algorithm='ball\_tree', leaf\_size=600, metric='manhattan',
                    metric\_params=None, n\_jobs=-1, n\_neighbors=5, p=2,
                    weights='uniform')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:} KNeighborsClassifier(algorithm='ball\_tree', leaf\_size=600, metric='manhattan',
                    metric\_params=None, n\_jobs=-1, n\_neighbors=5, p=2,
                    weights='uniform')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{c+c1}{\PYZsh{}Evaluation Metrics for KNN k=5 \PYZhy{}\PYZhy{} 2 labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}preds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}preds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}preds1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{knn\PYZus{}preds1}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Evaluation Metrics for KNN k=5 \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{knn\PYZus{}preds2}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{knn\PYZus{}preds2}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{knn\PYZus{}preds2}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{knn\PYZus{}preds2}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{knn\PYZus{}preds2}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{knn\PYZus{}preds2}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{knn\PYZus{}preds2}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[227642  22794]
 [   977  59616]]
0.923573043028
0.946429379698
0.859566933948
0.892076055409

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}63}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_33_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99572651  0.72340735]
recall: [ 0.90898273  0.98387603]
fscore: [ 0.95037939  0.83377272]
support: [250436  60593]
[[223384      1      0   6301    167]
 [   135    258      3  15582    211]
 [     1     10     16     64    137]
 [   768     24      8  59617    176]
 [   178      1      0    849   3138]]
0.920856254561
0.55902023168
0.801650312904
0.551786905652

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}63}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_33_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99517967  0.87755102  0.59259259  0.72339315  0.81953513]
recall: [ 0.97185593  0.01593675  0.07017544  0.98389253  0.75324052]
fscore: [ 0.98337952  0.03130498  0.1254902   0.83376921  0.78499062]
support: [229853  16189    228  60593   4166]

    \end{Verbatim}

    We see that with the use of KNN (k=5) and Manhattan Distance metric we
are able to improve the accuracy (92.357 percent) and F1 score (89.20
percent) slightly more than in logistic regression for a 2-label
classification. For multi-label classification as well, we see an
improvement in recall scores overall and especially for "R2L" and "U2R"
categories (as compared to logistic regression). Also, we see that the
F1 score for "normal" labels has increased too.

    \subsubsection{Support Vector Machine}\label{support-vector-machine}

We use a Support Vector Machine (using a linear and polynomial kernel)
model trained on the training dataset to predict "normal" and "bad" as
well as multi-class labels on the test dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{c+c1}{\PYZsh{}Training using an SVM model (kernel = linear) \PYZhy{}\PYZhy{} 2 labels}
         
         \PY{n}{svm\PYZus{}mod1} \PY{o}{=} \PY{n}{BaggingClassifier}\PY{p}{(}\PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}\PY{n}{max\PYZus{}samples} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{svm\PYZus{}mod1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs}\PY{p}{)}
         \PY{n}{svm\PYZus{}preds1} \PY{o}{=} \PY{n}{svm\PYZus{}mod1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{svm\PYZus{}preds1}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Training using an SVM model (kernel = linear) \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{n}{svm\PYZus{}mod2} \PY{o}{=} \PY{n}{BaggingClassifier}\PY{p}{(}\PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}\PY{n}{max\PYZus{}samples} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{svm\PYZus{}mod2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{)}
         \PY{n}{svm\PYZus{}preds2} \PY{o}{=} \PY{n}{svm\PYZus{}mod2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{svm\PYZus{}preds2}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}64}]:} BaggingClassifier(base\_estimator=SVC(C=1.0, cache\_size=200, class\_weight=None, coef0=0.0,
           decision\_function\_shape='ovr', degree=3, gamma='auto', kernel='linear',
           max\_iter=-1, probability=False, random\_state=None, shrinking=True,
           tol=0.001, verbose=False),
                  bootstrap=True, bootstrap\_features=False, max\_features=1.0,
                  max\_samples=0.1, n\_estimators=10, n\_jobs=-1, oob\_score=False,
                  random\_state=None, verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}64}]:} BaggingClassifier(base\_estimator=SVC(C=1.0, cache\_size=200, class\_weight=None, coef0=0.0,
           decision\_function\_shape='ovr', degree=3, gamma='auto', kernel='linear',
           max\_iter=-1, probability=False, random\_state=None, shrinking=True,
           tol=0.001, verbose=False),
                  bootstrap=True, bootstrap\_features=False, max\_features=1.0,
                  max\_samples=0.1, n\_estimators=10, n\_jobs=-1, oob\_score=False,
                  random\_state=None, verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{}Evaluation Metrics for SVM (kernel = linear) \PYZhy{}\PYZhy{} 2 labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds1}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Evaluation Metrics for SVM (kernel = linear) \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds2}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds2}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds2}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds2}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds2}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds2}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds2}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[227330  23106]
 [  1004  59589]]
0.922483112507
0.945583668046
0.858095317171
0.890689635091

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}65}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_37_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99560293  0.7205877 ]
recall: [ 0.90773691  0.98343043]
fscore: [ 0.94964179  0.83173748]
support: [250436  60593]
[[214488      0      0  15365      0]
 [     7    706      1  15465     10]
 [    23      6     10    127     62]
 [   783     56      6  59653     95]
 [   242      0      0   1037   2887]]
0.892984255487
0.539619994252
0.819765755251
0.542285908297

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}65}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_37_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99510539  0.91927083  0.58823529  0.65089965  0.94531762]
recall: [ 0.93315293  0.04360986  0.04385965  0.98448666  0.69299088]
fscore: [ 0.96313393  0.08326945  0.08163265  0.78367052  0.79972299]
support: [229853  16189    228  60593   4166]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{c+c1}{\PYZsh{}SVM using a polynomial kernel \PYZhy{}\PYZhy{} 2 labels}
         \PY{n}{svm\PYZus{}mod3} \PY{o}{=} \PY{n}{BaggingClassifier}\PY{p}{(}\PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{cache\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{7000}\PY{p}{)}\PY{p}{,}\PY{n}{max\PYZus{}samples} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{svm\PYZus{}mod3}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs}\PY{p}{)}
         \PY{n}{svm\PYZus{}preds3} \PY{o}{=} \PY{n}{svm\PYZus{}mod3}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{svm\PYZus{}preds3}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}SVM using a polynomial kernel \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{n}{svm\PYZus{}mod4} \PY{o}{=} \PY{n}{BaggingClassifier}\PY{p}{(}\PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{cache\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{7000}\PY{p}{)}\PY{p}{,}\PY{n}{max\PYZus{}samples} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{svm\PYZus{}mod4}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{)}
         \PY{n}{svm\PYZus{}preds4} \PY{o}{=} \PY{n}{svm\PYZus{}mod4}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{svm\PYZus{}preds4}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}66}]:} BaggingClassifier(base\_estimator=SVC(C=1.0, cache\_size=7000, class\_weight=None, coef0=0.0,
           decision\_function\_shape='ovr', degree=3, gamma='auto', kernel='poly',
           max\_iter=-1, probability=False, random\_state=None, shrinking=True,
           tol=0.001, verbose=False),
                  bootstrap=True, bootstrap\_features=False, max\_features=1.0,
                  max\_samples=0.1, n\_estimators=10, n\_jobs=-1, oob\_score=False,
                  random\_state=None, verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}66}]:} BaggingClassifier(base\_estimator=SVC(C=1.0, cache\_size=7000, class\_weight=None, coef0=0.0,
           decision\_function\_shape='ovr', degree=3, gamma='auto', kernel='poly',
           max\_iter=-1, probability=False, random\_state=None, shrinking=True,
           tol=0.001, verbose=False),
                  bootstrap=True, bootstrap\_features=False, max\_features=1.0,
                  max\_samples=0.1, n\_estimators=10, n\_jobs=-1, oob\_score=False,
                  random\_state=None, verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{}Evaluation Metrics for SVM (kernel = polynomial) \PYZhy{}\PYZhy{} 2 labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds3}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds3}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds3}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds3}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds3}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds3}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{svm\PYZus{}preds3}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Evaluation Metrics for SVM (kernel = polynomial) \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds4}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds4}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds4}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds4}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds4}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds4}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{svm\PYZus{}preds4}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[227644  22792]
 [  1273  59320]]
0.92262779355
0.943990846369
0.85843346792
0.890581158956

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}67}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_39_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99443903  0.7224279 ]
recall: [ 0.90899072  0.97899097]
fscore: [ 0.94979691  0.8313654 ]
support: [250436  60593]
[[222990      0      0   6752    111]
 [    10    438      2  15662     77]
 [     7      5     17     74    125]
 [  1051     33      2  59362    145]
 [    93      2      0    849   3222]]
0.919621642998
0.56496929286
0.862802737883
0.564257481699

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}67}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_39_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99482046  0.91631799  0.80952381  0.71780795  0.87554348]
recall: [ 0.97014179  0.02705541  0.0745614   0.97968412  0.77340374]
fscore: [ 0.98232615  0.05255895  0.13654618  0.82854591  0.82131022]
support: [229853  16189    228  60593   4166]

    \end{Verbatim}

    We see that the polynomial SVM performs better than logistic regression
but almost similar to KNN.

    \subsubsection{Random Forest}\label{random-forest}

We now use a Random Forest model trained on the training dataset to
predict "normal" and "bad" as well as multi-class labels on the test
dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{c+c1}{\PYZsh{}Random Forest Model \PYZhy{}\PYZhy{} 2 labels}
         \PY{n}{rdforestmod} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{rdforestmod}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs}\PY{p}{)}
         \PY{n}{rdpreds} \PY{o}{=} \PY{n}{rdforestmod}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{rdpreds}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Random Forest Model \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{n}{rdforestmod1} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{rdforestmod1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{)}
         \PY{n}{rdpreds1} \PY{o}{=} \PY{n}{rdforestmod1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{rdpreds1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}98}]:} RandomForestClassifier(bootstrap=True, class\_weight=None, criterion='gini',
                     max\_depth=None, max\_features='auto', max\_leaf\_nodes=None,
                     min\_impurity\_decrease=0.0, min\_impurity\_split=None,
                     min\_samples\_leaf=1, min\_samples\_split=2,
                     min\_weight\_fraction\_leaf=0.0, n\_estimators=10, n\_jobs=-1,
                     oob\_score=False, random\_state=0, verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}98}]:} RandomForestClassifier(bootstrap=True, class\_weight=None, criterion='gini',
                     max\_depth=None, max\_features='auto', max\_leaf\_nodes=None,
                     min\_impurity\_decrease=0.0, min\_impurity\_split=None,
                     min\_samples\_leaf=1, min\_samples\_split=2,
                     min\_weight\_fraction\_leaf=0.0, n\_estimators=10, n\_jobs=-1,
                     oob\_score=False, random\_state=0, verbose=0, warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{c+c1}{\PYZsh{}Evaluation Metrics for Random Forest \PYZhy{}\PYZhy{} 2 labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{rdpreds}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{rdpreds}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{rdpreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{rdpreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{rdpreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{rdpreds}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{rdpreds}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Evaluation Metrics for Random Forest \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{rdpreds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{rdpreds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{rdpreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{rdpreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{rdpreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{rdpreds1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{rdpreds1}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[227882  22554]
 [   325  60268]]
0.926440942806
0.952288703459
0.863128452653
0.896335123835

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}69}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_43_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99857585  0.72768105]
recall: [ 0.90994106  0.99463634]
fscore: [ 0.95220028  0.84046996]
support: [250436  60593]
[[223802      6      0   6014     31]
 [    63    223      5  15463    435]
 [     2      3      8    204     11]
 [    57      4      2  60295    235]
 [   178      1      0    781   3206]]
0.924460420089
0.557436410762
0.803955281697
0.542680957055

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}69}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_43_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99866132  0.94092827  0.53333333  0.72857885  0.81827463]
recall: [ 0.97367448  0.01377479  0.03508772  0.99508194  0.76956313]
fscore: [ 0.98600963  0.02715208  0.06584362  0.84122776  0.7931717 ]
support: [229853  16189    228  60593   4166]

    \end{Verbatim}

    We see that the accuracy (92.64 percent) and F1 score (89.63 percent)
for the 2-label classification has improved a lot as compared to the
previous models. The F1 score for "normal" labels is also significantly
higher (84.05 percent). However, in the multi-class classification,
though the overall accuracy is higher, the recall values and F1 scores
for "U2R" and "R2L" are low, leading to a lower F1 score overall.

    \subsubsection{Neural Networks}\label{neural-networks}

We now use a Neural Network model (Multi-Layer Perceptron) trained on
the training dataset to predict "normal" and "bad" labels on the test
dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{}Multi Layer Perceptron Model \PYZhy{}\PYZhy{} 2 labels}
         \PY{n}{mlpmod} \PY{o}{=} \PY{n}{MLPClassifier}\PY{p}{(}\PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tanh}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{mlpmod}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs}\PY{p}{)}
         \PY{n}{mlppreds} \PY{o}{=} \PY{n}{mlpmod}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{mlppreds}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Multi Layer Perceptron Model \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{n}{mlpmod1} \PY{o}{=} \PY{n}{MLPClassifier}\PY{p}{(}\PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tanh}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{mlpmod1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{)}
         \PY{n}{mlppreds1} \PY{o}{=} \PY{n}{mlpmod1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{mlppreds1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}70}]:} MLPClassifier(activation='tanh', alpha=0.0001, batch\_size='auto', beta\_1=0.9,
                beta\_2=0.999, early\_stopping=False, epsilon=1e-08,
                hidden\_layer\_sizes=(100,), learning\_rate='constant',
                learning\_rate\_init=0.001, max\_iter=200, momentum=0.9,
                nesterovs\_momentum=True, power\_t=0.5, random\_state=0, shuffle=True,
                solver='adam', tol=0.0001, validation\_fraction=0.1, verbose=False,
                warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}70}]:} MLPClassifier(activation='tanh', alpha=0.0001, batch\_size='auto', beta\_1=0.9,
                beta\_2=0.999, early\_stopping=False, epsilon=1e-08,
                hidden\_layer\_sizes=(100,), learning\_rate='constant',
                learning\_rate\_init=0.001, max\_iter=200, momentum=0.9,
                nesterovs\_momentum=True, power\_t=0.5, random\_state=0, shuffle=True,
                solver='adam', tol=0.0001, validation\_fraction=0.1, verbose=False,
                warm\_start=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{c+c1}{\PYZsh{}Evaluation Metrics for an MLP Classifier \PYZhy{}\PYZhy{} 2 labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{mlppreds}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{mlppreds}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{mlppreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{mlppreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{mlppreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{mlppreds}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{mlppreds}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Evaluation Metrics for an MLP Classifier \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{mlppreds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{mlppreds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{mlppreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{mlppreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{mlppreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{mlppreds1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{mlppreds1}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[227791  22645]
 [   966  59627]]
0.924087464513
0.946817630451
0.860265825686
0.892729833571

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}71}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_47_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99577718  0.72475447]
recall: [ 0.9095777   0.98405756]
fscore: [ 0.95072758  0.83473209]
support: [250436  60593]
[[223577      1      0   6106    169]
 [    32     64      3  15778    312]
 [     3     12     18    146     49]
 [   758     22      4  59647    162]
 [   181      1      0   1195   2789]]
0.91983384186
0.541890202544
0.775323506598
0.539030370367

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}71}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_47_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99566246  0.64        0.72        0.71974853  0.80120655]
recall: [ 0.97269559  0.0039533   0.07894737  0.98438764  0.66946711]
fscore: [ 0.98404503  0.00785806  0.14229249  0.83151988  0.72943638]
support: [229853  16189    228  60593   4166]

    \end{Verbatim}

    We observe that the accuracy and F1 scores for a Multi-Layer Perceptron
are very close to those for the Random Forest model for the 2-label as
well as multi-label classification. The best performance that we observe
from among the implemented learning models (based on accuracy) is of the
Random Forest model, followed closely by the Multi-Layer Perceptron
model. The best performance (based on recall and F1 score) for
multi-class classification is by the polynomial SVM model.

    \subsubsection{Ensemble Modeling}\label{ensemble-modeling}

As we have already observed, Random Forest models provide the best
results for the 2-label detection problem. However, for the multi-class
detection problem, Polynomial SVM seem to provide a better F1 score.
Here, we attempt to design an ensemble model of two random forests and
one polynomial SVM model in order to improve the accuracy of the
results.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{c+c1}{\PYZsh{}Ensemble Modeling \PYZhy{} Three different learning models}
         \PY{c+c1}{\PYZsh{}Test on 2 label as well as multi\PYZhy{}class}
         
         \PY{n}{rdforestmod} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,}\PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqrt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{rdforestmod1} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,}\PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{polysvmmod} \PY{o}{=} \PY{n}{BaggingClassifier}\PY{p}{(}\PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{cache\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{7000}\PY{p}{)}\PY{p}{,}\PY{n}{max\PYZus{}samples} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{modelest} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{modelest}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforest}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rdforestmod}\PY{p}{)}\PY{p}{)}
         \PY{n}{modelest}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestanother}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rdforestmod1}\PY{p}{)}\PY{p}{)}
         \PY{n}{modelest}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{polysvmmod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{polysvmmod}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ensemblemod} \PY{o}{=} \PY{n}{VotingClassifier}\PY{p}{(}\PY{n}{modelest}\PY{p}{,}\PY{n}{voting}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{soft}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}2\PYZhy{}label}
         \PY{n}{ensemblemod}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs}\PY{p}{)}
         \PY{n}{enspreds} \PY{o}{=} \PY{n}{ensemblemod}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{enspreds}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}multi\PYZhy{}label}
         \PY{n}{ensemblemod1} \PY{o}{=} \PY{n}{VotingClassifier}\PY{p}{(}\PY{n}{modelest}\PY{p}{,}\PY{n}{voting}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{soft}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ensemblemod1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}train\PYZus{}10per\PYZus{}scaled}\PY{p}{,} \PY{n}{attack\PYZus{}labs\PYZus{}all}\PY{p}{)}
         \PY{n}{enspreds1} \PY{o}{=} \PY{n}{ensemblemod1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{enspreds1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:} VotingClassifier(estimators=[('randomforest', RandomForestClassifier(bootstrap=True, class\_weight=None, criterion='gini',
                     max\_depth=None, max\_features='sqrt', max\_leaf\_nodes=None,
                     min\_impurity\_decrease=0.0, min\_impurity\_split=None,
                     min\_samples\_leaf=1, min\_samples\_split=2,
                 {\ldots}stimators=10, n\_jobs=-1, oob\_score=False,
                  random\_state=None, verbose=0, warm\_start=False))],
                  flatten\_transform=None, n\_jobs=1, voting='soft', weights=None)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:} VotingClassifier(estimators=[('randomforest', RandomForestClassifier(bootstrap=True, class\_weight=None, criterion='gini',
                     max\_depth=None, max\_features='sqrt', max\_leaf\_nodes=None,
                     min\_impurity\_decrease=0.0, min\_impurity\_split=None,
                     min\_samples\_leaf=1, min\_samples\_split=2,
                 {\ldots}stimators=10, n\_jobs=-1, oob\_score=False,
                  random\_state=None, verbose=0, warm\_start=False))],
                  flatten\_transform=None, n\_jobs=1, voting='soft', weights=None)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
['normal.' 'normal.' 'normal.' {\ldots}, 'normal.' 'normal.' 'normal.']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{c+c1}{\PYZsh{}Evaluation Metrics for the ensemble model \PYZhy{}\PYZhy{} 2 labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{enspreds}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{enspreds}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{enspreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{enspreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{enspreds}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{enspreds}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{,} \PY{n}{enspreds}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Evaluation Metrics for the ensemble model \PYZhy{}\PYZhy{} multi\PYZhy{}labels}
         \PY{c+c1}{\PYZsh{}Confusion Matrix, accuracy, recall, precision and f1\PYZhy{}score}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{enspreds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{enspreds1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{enspreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{enspreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{enspreds1}\PY{p}{,}\PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ht} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{enspreds1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ht}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Another way to view these metrics for every class label}
         \PY{n}{precision}\PY{p}{,} \PY{n}{recall}\PY{p}{,} \PY{n}{fscore}\PY{p}{,} \PY{n}{support} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}recall\PYZus{}fscore\PYZus{}support}\PY{p}{(}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{,} \PY{n}{enspreds1}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{precision: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{precision}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{recall: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{recall}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fscore: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{fscore}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{support: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{support}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[228013  22423]
 [   301  60292]]
0.926939288619
0.952748290005
0.863797085589
0.896983582535

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}73}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_51_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99868164  0.72891253]
recall: [ 0.91046415  0.99503243]
fscore: [ 0.95253473  0.84143244]
support: [250436  60593]
[[223529      0      0   6231     93]
 [     1    308      3  15605    272]
 [     2      3     10    176     37]
 [   632      1      1  59724    235]
 [   156      0      0    908   3102]]
0.921692189474
0.553125844344
0.850047694608
0.544609641423

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}73}]:} [Text(33,0.5,'True Values'), Text(0.5,15,'Predicted Values')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_51_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
precision: [ 0.99647379  0.98717949  0.71428571  0.72266589  0.82963359]
recall: [ 0.97248676  0.01902526  0.04385965  0.98565841  0.74459914]
fscore: [ 0.98433416  0.03733107  0.08264463  0.83391861  0.78481973]
support: [229853  16189    228  60593   4166]

    \end{Verbatim}

    We observe that the accuracy and F1 score have improved significantly
for the 2-label classification over the previous models by using an
ensemble model system. The F1 scores for multi-class classification too
are higher than the Random Forest classifier.

    \subsubsection{Unsupervised Learning -
Clustering}\label{unsupervised-learning---clustering}

The above learning methods trained a model on the training data and
using the training labels, which was used later to predict the
corresponding labels for the test data. Here, we try a different
learning technique where we use a clustering algorithm on the test data
to identify patterns which we can later verify using the already
provided target labels.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{c+c1}{\PYZsh{}Clustering implemented using K\PYZhy{}Means on test dataset (n=5 clusters)}
         
         \PY{n}{kmeans\PYZus{}mod} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{kmeans\PYZus{}mod}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)} 
         \PY{n}{labels} \PY{o}{=} \PY{n}{kmeans\PYZus{}mod}\PY{o}{.}\PY{n}{labels\PYZus{}}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}74}]:} KMeans(algorithm='auto', copy\_x=True, init='k-means++', max\_iter=300,
             n\_clusters=5, n\_init=10, n\_jobs=1, precompute\_distances='auto',
             random\_state=None, tol=0.0001, verbose=0)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{labels}\PY{p}{)}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}75}]:} 3    164804
         0    101311
         1     44191
         2       722
         4         1
         dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}144}]:} \PY{c+c1}{\PYZsh{}Check with target labels for the test dataset}
          
          \PY{n}{cluster\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{labels}\PY{p}{)}
          \PY{n}{clust\PYZus{}map} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{cluster\PYZus{}labels}\PY{p}{,}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{clust\PYZus{}map}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n+nb}{type}\PY{p}{(}\PY{n}{clust\PYZus{}map}\PY{p}{)}
          \PY{n}{clust\PYZus{}map}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
          
          \PY{n}{df} \PY{o}{=} \PY{n}{clust\PYZus{}map}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
          
          \PY{n}{df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}  \PY{n}{color}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cluster Distribution}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:}    cluster attack\_type
          0        0     normal.
          1        0     normal.
          2        0     normal.
          3        0        bad.
          4        0        bad.
          5        0        bad.
          6        0     normal.
          7        0     normal.
          8        0        bad.
          9        0     normal.
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:}    cluster attack\_type  counts
          0        0        bad.   41572
          1        0     normal.   59739
          2        1        bad.   44076
          3        1     normal.     115
          4        2        bad.     717
          5        2     normal.       5
          6        3        bad.  164071
          7        3     normal.     733
          8        4     normal.       1
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x266a648ca90>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:} Text(0.5,0,'Clusters')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:} Text(0,0.5,'Counts')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:} Text(0.5,1,'Cluster Distribution')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_56_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}145}]:} \PY{c+c1}{\PYZsh{}Doing this for all major attack types in the test dataset}
          
          \PY{n}{clust\PYZus{}map} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{cluster\PYZus{}labels}\PY{p}{,}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{clust\PYZus{}map}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n+nb}{type}\PY{p}{(}\PY{n}{clust\PYZus{}map}\PY{p}{)}
          \PY{n}{clust\PYZus{}map}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
          
          \PY{n}{df} \PY{o}{=} \PY{n}{clust\PYZus{}map}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
          
          \PY{n}{df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}  \PY{n}{color}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yellow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cluster Distribution}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:}    cluster attack\_type
          0        0     normal.
          1        0     normal.
          2        0     normal.
          3        0        R2L.
          4        0        R2L.
          5        0        R2L.
          6        0     normal.
          7        0     normal.
          8        0        R2L.
          9        0     normal.
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:}     cluster attack\_type  counts
          0         0        DOS.   24831
          1         0        R2L.   15465
          2         0         U2R      89
          3         0     normal.   59739
          4         0      probe.    1187
          5         1        DOS.   40955
          6         1        R2L.       9
          7         1         U2R     136
          8         1     normal.     115
          9         1      probe.    2976
          10        2        R2L.     714
          11        2         U2R       3
          12        2     normal.       5
          13        3        DOS.  164067
          14        3        R2L.       1
          15        3     normal.     733
          16        3      probe.       3
          17        4     normal.       1
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x26746543c88>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:} Text(0.5,0,'Clusters')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:} Text(0,0.5,'Counts')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:} Text(0.5,1,'Cluster Distribution')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_57_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We see that most of the clusters show one particular type of attack or
normal as the dominant type in the cluster. We can do it for more
clusters for greater granularity.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}148}]:} \PY{c+c1}{\PYZsh{}Clustering for n=10 clusters}
          
          \PY{n}{kmeans\PYZus{}mod1} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          \PY{n}{kmeans\PYZus{}mod1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{kdd\PYZus{}test\PYZus{}10per\PYZus{}scaled}\PY{p}{)} 
          \PY{n}{labels1} \PY{o}{=} \PY{n}{kmeans\PYZus{}mod1}\PY{o}{.}\PY{n}{labels\PYZus{}}
          
          \PY{c+c1}{\PYZsh{}Check with target labels for the test dataset}
          
          \PY{n}{cluster\PYZus{}labels1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{labels1}\PY{p}{)}
          \PY{n}{clust\PYZus{}map1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{cluster\PYZus{}labels1}\PY{p}{,}\PY{n}{attack\PYZus{}labs\PYZus{}tall}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{clust\PYZus{}map2} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{cluster\PYZus{}labels1}\PY{p}{,}\PY{n}{attack\PYZus{}labs\PYZus{}test}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{clust\PYZus{}map1}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{clust\PYZus{}map2}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          
          \PY{n}{df} \PY{o}{=} \PY{n}{clust\PYZus{}map2}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
          
          \PY{n}{df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}  \PY{n}{color}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cluster Distribution}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{df} \PY{o}{=} \PY{n}{clust\PYZus{}map1}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
          \PY{n}{df1}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attack\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df1}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
          
          \PY{n}{df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}  \PY{n}{color}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yellow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{grid}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Counts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cluster Distribution}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} KMeans(algorithm='auto', copy\_x=True, init='k-means++', max\_iter=300,
              n\_clusters=10, n\_init=10, n\_jobs=1, precompute\_distances='auto',
              random\_state=None, tol=0.0001, verbose=0)
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:}     cluster attack\_type  counts
          0         0        bad.  164005
          1         0     normal.     728
          2         1        bad.   41470
          3         1     normal.      95
          4         2        bad.     717
          5         2     normal.       5
          6         3        bad.       5
          7         4        bad.   18096
          8         4     normal.      23
          9         5     normal.       1
          10        6        bad.   23043
          11        6     normal.   59357
          12        7        bad.    3081
          13        7     normal.     380
          14        8     normal.       3
          15        9        bad.      19
          16        9     normal.       1
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x268bb5a8d30>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} Text(0.5,0,'Clusters')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} Text(0,0.5,'Counts')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} Text(0.5,1,'Cluster Distribution')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_59_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:}     cluster attack\_type  counts
          0         0        DOS.  164001
          1         0        R2L.       1
          2         0     normal.     728
          3         0      probe.       3
          4         1        DOS.   40905
          5         1        R2L.       5
          6         1         U2R     117
          7         1     normal.      95
          8         1      probe.     443
          9         2        R2L.     714
          10        2         U2R       3
          11        2     normal.       5
          12        3         U2R       5
          13        4        DOS.   17813
          14        4        R2L.       3
          15        4     normal.      23
          16        4      probe.     280
          17        5     normal.       1
          18        6        DOS.    7113
          19        6        R2L.   15387
          20        6         U2R      66
          21        6     normal.   59357
          22        6      probe.     477
          23        7        DOS.      21
          24        7        R2L.      77
          25        7         U2R      20
          26        7     normal.     380
          27        7      probe.    2963
          28        8     normal.       3
          29        9        R2L.       2
          30        9         U2R      17
          31        9     normal.       1
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x267463c2198>
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} Text(0.5,0,'Clusters')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} Text(0,0.5,'Counts')
\end{Verbatim}
            
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}148}]:} Text(0.5,1,'Cluster Distribution')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{DosDetection-Copy1_files/DosDetection-Copy1_59_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We observe similar results here as well. Hence, we see that even if we
do not have a training dataset to train a supervised model on,
unsupervised algorithms like clustering can give us a fairly good idea
reagarding the classification of "bad" intrusions from "normal" traffic
signatures.


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
